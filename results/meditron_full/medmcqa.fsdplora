nohup: ignoring input
2024-10-30:18:06:28,426 INFO     [__main__.py:279] Verbosity set to INFO
2024-10-30:18:06:34,362 INFO     [__init__.py:459] The tag 'arc_ca' is already registered as a group, this tag will not be registered. This may affect tasks you want to call.
2024-10-30:18:06:34,369 INFO     [__init__.py:459] The tag 'arc_ca' is already registered as a group, this tag will not be registered. This may affect tasks you want to call.
2024-10-30:18:06:37,539 INFO     [__main__.py:376] Selected Tasks: ['medmcqa']
2024-10-30:18:06:37,542 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-10-30:18:06:37,542 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'epfl-llm/meditron-7b', 'dtype': 'float16', 'low_cpu_mem_usage': True, 'trust_remote_code': True, 'peft': '/mnt/dg_tunning/lora4_meditron_7b'}
2024-10-30:18:06:37,846 WARNING  [other.py:349] Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
2024-10-30:18:06:37,847 INFO     [huggingface.py:129] Using device 'cuda'
2024-10-30:18:06:37,916 INFO     [huggingface.py:481] Using model type 'default'
2024-10-30:18:06:38,063 INFO     [huggingface.py:365] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:13,  1.93s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:03<00:10,  1.80s/it]Loading checkpoint shards:  38%|███▊      | 3/8 [00:05<00:08,  1.74s/it]Loading checkpoint shards:  50%|█████     | 4/8 [00:07<00:07,  1.77s/it]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:08<00:05,  1.80s/it]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:10<00:03,  1.78s/it]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:12<00:01,  1.71s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:12<00:00,  1.24s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:12<00:00,  1.56s/it]
Generating train split:   0%|          | 0/182822 [00:00<?, ? examples/s]Generating train split:  10%|▉         | 18000/182822 [00:00<00:00, 169139.94 examples/s]Generating train split:  22%|██▏       | 40000/182822 [00:00<00:00, 194962.38 examples/s]Generating train split:  34%|███▍      | 63000/182822 [00:00<00:00, 205642.08 examples/s]Generating train split:  48%|████▊     | 87000/182822 [00:00<00:00, 214423.37 examples/s]Generating train split:  60%|█████▉    | 109000/182822 [00:00<00:00, 213339.69 examples/s]Generating train split:  73%|███████▎  | 134000/182822 [00:00<00:00, 220449.77 examples/s]Generating train split:  86%|████████▌ | 157000/182822 [00:00<00:00, 220040.01 examples/s]Generating train split:  99%|█████████▉| 181000/182822 [00:00<00:00, 222299.28 examples/s]Generating train split: 100%|██████████| 182822/182822 [00:00<00:00, 214592.36 examples/s]
Generating test split:   0%|          | 0/6150 [00:00<?, ? examples/s]Generating test split: 100%|██████████| 6150/6150 [00:00<00:00, 432983.12 examples/s]
Generating validation split:   0%|          | 0/4183 [00:00<?, ? examples/s]Generating validation split: 100%|██████████| 4183/4183 [00:00<00:00, 267177.94 examples/s]
2024-10-30:18:07:09,844 WARNING  [evaluator.py:270] Overwriting default num_fewshot of medmcqa from None to 3
2024-10-30:18:07:09,844 WARNING  [model.py:422] model.chat_template was called with the chat_template set to False or None. Therefore no chat template will be applied. Make sure this is an intended behavior.
2024-10-30:18:07:09,846 INFO     [task.py:415] Building contexts for medmcqa on rank 0...
  0%|          | 0/4183 [00:00<?, ?it/s] 52%|█████▏    | 2192/4183 [00:00<00:00, 21913.65it/s]100%|██████████| 4183/4183 [00:00<00:00, 22646.19it/s]
2024-10-30:18:07:10,359 INFO     [evaluator.py:489] Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/16732 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/16732 [00:45<211:53:49, 45.59s/it]Running loglikelihood requests:   1%|          | 129/16732 [00:48<1:15:30,  3.66it/s]Running loglikelihood requests:   2%|▏         | 257/16732 [00:51<34:39,  7.92it/s]  Running loglikelihood requests:   2%|▏         | 385/16732 [00:54<21:28, 12.68it/s]Running loglikelihood requests:   3%|▎         | 513/16732 [00:57<15:10, 17.81it/s]Running loglikelihood requests:   4%|▍         | 641/16732 [01:00<11:39, 23.00it/s]Running loglikelihood requests:   5%|▍         | 769/16732 [01:02<09:29, 28.01it/s]Running loglikelihood requests:   5%|▌         | 897/16732 [01:05<08:05, 32.63it/s]Running loglikelihood requests:   6%|▌         | 1025/16732 [01:07<07:07, 36.76it/s]Running loglikelihood requests:   7%|▋         | 1153/16732 [01:10<06:24, 40.52it/s]Running loglikelihood requests:   8%|▊         | 1281/16732 [01:12<05:53, 43.66it/s]Running loglikelihood requests:   8%|▊         | 1409/16732 [01:15<05:31, 46.28it/s]Running loglikelihood requests:   9%|▉         | 1537/16732 [01:17<05:13, 48.45it/s]Running loglikelihood requests:  10%|▉         | 1665/16732 [01:19<04:59, 50.33it/s]Running loglikelihood requests:  11%|█         | 1793/16732 [01:22<04:48, 51.76it/s]Running loglikelihood requests:  11%|█▏        | 1921/16732 [01:24<04:39, 52.96it/s]Running loglikelihood requests:  12%|█▏        | 2049/16732 [01:26<04:32, 53.95it/s]Running loglikelihood requests:  13%|█▎        | 2177/16732 [01:28<04:25, 54.80it/s]Running loglikelihood requests:  14%|█▍        | 2305/16732 [01:31<04:20, 55.43it/s]Running loglikelihood requests:  15%|█▍        | 2433/16732 [01:33<04:15, 55.87it/s]Running loglikelihood requests:  15%|█▌        | 2561/16732 [01:35<04:12, 56.22it/s]Running loglikelihood requests:  16%|█▌        | 2689/16732 [01:37<04:07, 56.82it/s]Running loglikelihood requests:  17%|█▋        | 2817/16732 [01:39<04:02, 57.30it/s]Running loglikelihood requests:  18%|█▊        | 2945/16732 [01:42<03:58, 57.69it/s]Running loglikelihood requests:  18%|█▊        | 3073/16732 [01:44<03:55, 58.00it/s]Running loglikelihood requests:  19%|█▉        | 3201/16732 [01:46<03:51, 58.38it/s]Running loglikelihood requests:  20%|█▉        | 3329/16732 [01:48<03:48, 58.68it/s]Running loglikelihood requests:  21%|██        | 3457/16732 [01:50<03:45, 59.00it/s]Running loglikelihood requests:  21%|██▏       | 3585/16732 [01:52<03:41, 59.24it/s]Running loglikelihood requests:  22%|██▏       | 3713/16732 [01:55<03:37, 59.75it/s]Running loglikelihood requests:  23%|██▎       | 3841/16732 [01:57<03:33, 60.34it/s]Running loglikelihood requests:  24%|██▎       | 3969/16732 [01:59<03:29, 60.98it/s]Running loglikelihood requests:  24%|██▍       | 4097/16732 [02:01<03:25, 61.47it/s]Running loglikelihood requests:  25%|██▌       | 4225/16732 [02:03<03:22, 61.82it/s]Running loglikelihood requests:  26%|██▌       | 4353/16732 [02:05<03:19, 62.13it/s]Running loglikelihood requests:  27%|██▋       | 4481/16732 [02:07<03:16, 62.39it/s]Running loglikelihood requests:  28%|██▊       | 4609/16732 [02:09<03:13, 62.60it/s]Running loglikelihood requests:  28%|██▊       | 4737/16732 [02:11<03:10, 62.89it/s]Running loglikelihood requests:  29%|██▉       | 4865/16732 [02:13<03:07, 63.14it/s]Running loglikelihood requests:  30%|██▉       | 4993/16732 [02:15<03:05, 63.36it/s]Running loglikelihood requests:  31%|███       | 5121/16732 [02:17<03:01, 63.95it/s]Running loglikelihood requests:  31%|███▏      | 5249/16732 [02:19<02:58, 64.39it/s]Running loglikelihood requests:  32%|███▏      | 5377/16732 [02:21<02:55, 64.72it/s]Running loglikelihood requests:  33%|███▎      | 5505/16732 [02:23<02:52, 65.00it/s]Running loglikelihood requests:  34%|███▎      | 5633/16732 [02:25<02:49, 65.36it/s]Running loglikelihood requests:  34%|███▍      | 5761/16732 [02:27<02:47, 65.66it/s]Running loglikelihood requests:  35%|███▌      | 5889/16732 [02:28<02:44, 65.89it/s]Running loglikelihood requests:  36%|███▌      | 6017/16732 [02:30<02:41, 66.19it/s]Running loglikelihood requests:  37%|███▋      | 6145/16732 [02:32<02:39, 66.42it/s]Running loglikelihood requests:  37%|███▋      | 6273/16732 [02:34<02:36, 66.62it/s]Running loglikelihood requests:  38%|███▊      | 6401/16732 [02:36<02:34, 66.79it/s]Running loglikelihood requests:  39%|███▉      | 6529/16732 [02:38<02:32, 66.97it/s]Running loglikelihood requests:  40%|███▉      | 6657/16732 [02:40<02:30, 67.15it/s]Running loglikelihood requests:  41%|████      | 6785/16732 [02:42<02:27, 67.31it/s]Running loglikelihood requests:  41%|████▏     | 6913/16732 [02:44<02:25, 67.40it/s]Running loglikelihood requests:  42%|████▏     | 7041/16732 [02:46<02:23, 67.48it/s]Running loglikelihood requests:  43%|████▎     | 7169/16732 [02:47<02:21, 67.77it/s]Running loglikelihood requests:  44%|████▎     | 7297/16732 [02:49<02:18, 68.01it/s]Running loglikelihood requests:  44%|████▍     | 7425/16732 [02:51<02:16, 68.20it/s]Running loglikelihood requests:  45%|████▌     | 7553/16732 [02:53<02:14, 68.31it/s]Running loglikelihood requests:  46%|████▌     | 7681/16732 [02:55<02:12, 68.43it/s]Running loglikelihood requests:  47%|████▋     | 7809/16732 [02:57<02:09, 68.85it/s]Running loglikelihood requests:  47%|████▋     | 7937/16732 [02:59<02:07, 69.18it/s]Running loglikelihood requests:  48%|████▊     | 8065/16732 [03:00<02:04, 69.45it/s]Running loglikelihood requests:  49%|████▉     | 8193/16732 [03:02<02:02, 69.69it/s]Running loglikelihood requests:  50%|████▉     | 8321/16732 [03:04<02:00, 69.81it/s]Running loglikelihood requests:  50%|█████     | 8449/16732 [03:06<01:58, 70.13it/s]Running loglikelihood requests:  51%|█████▏    | 8577/16732 [03:08<01:55, 70.38it/s]Running loglikelihood requests:  52%|█████▏    | 8705/16732 [03:09<01:53, 70.59it/s]Running loglikelihood requests:  53%|█████▎    | 8833/16732 [03:11<01:51, 70.77it/s]Running loglikelihood requests:  54%|█████▎    | 8961/16732 [03:13<01:49, 70.90it/s]Running loglikelihood requests:  54%|█████▍    | 9089/16732 [03:15<01:47, 71.11it/s]Running loglikelihood requests:  55%|█████▌    | 9217/16732 [03:17<01:45, 71.28it/s]Running loglikelihood requests:  56%|█████▌    | 9345/16732 [03:18<01:43, 71.44it/s]Running loglikelihood requests:  57%|█████▋    | 9473/16732 [03:20<01:41, 71.60it/s]Running loglikelihood requests:  57%|█████▋    | 9601/16732 [03:22<01:39, 71.86it/s]Running loglikelihood requests:  58%|█████▊    | 9729/16732 [03:24<01:37, 72.08it/s]Running loglikelihood requests:  59%|█████▉    | 9857/16732 [03:25<01:35, 72.24it/s]Running loglikelihood requests:  60%|█████▉    | 9985/16732 [03:27<01:33, 72.38it/s]Running loglikelihood requests:  60%|██████    | 10113/16732 [03:29<01:31, 72.52it/s]Running loglikelihood requests:  61%|██████    | 10241/16732 [03:31<01:29, 72.59it/s]Running loglikelihood requests:  62%|██████▏   | 10369/16732 [03:32<01:27, 72.85it/s]Running loglikelihood requests:  63%|██████▎   | 10497/16732 [03:34<01:25, 73.06it/s]Running loglikelihood requests:  64%|██████▎   | 10625/16732 [03:36<01:23, 73.25it/s]Running loglikelihood requests:  64%|██████▍   | 10753/16732 [03:38<01:21, 73.40it/s]Running loglikelihood requests:  65%|██████▌   | 10881/16732 [03:39<01:19, 73.85it/s]Running loglikelihood requests:  66%|██████▌   | 11009/16732 [03:41<01:17, 74.14it/s]Running loglikelihood requests:  67%|██████▋   | 11137/16732 [03:43<01:15, 74.40it/s]Running loglikelihood requests:  67%|██████▋   | 11265/16732 [03:45<01:13, 74.60it/s]Running loglikelihood requests:  68%|██████▊   | 11393/16732 [03:46<01:11, 74.80it/s]Running loglikelihood requests:  69%|██████▉   | 11521/16732 [03:48<01:09, 74.90it/s]Running loglikelihood requests:  70%|██████▉   | 11649/16732 [03:50<01:07, 75.11it/s]Running loglikelihood requests:  70%|███████   | 11777/16732 [03:51<01:05, 75.29it/s]Running loglikelihood requests:  71%|███████   | 11905/16732 [03:53<01:03, 75.44it/s]Running loglikelihood requests:  72%|███████▏  | 12033/16732 [03:55<01:02, 75.56it/s]Running loglikelihood requests:  73%|███████▎  | 12161/16732 [03:56<01:00, 75.69it/s]Running loglikelihood requests:  73%|███████▎  | 12289/16732 [03:58<00:58, 76.08it/s]Running loglikelihood requests:  74%|███████▍  | 12417/16732 [04:00<00:56, 76.34it/s]Running loglikelihood requests:  75%|███████▍  | 12545/16732 [04:01<00:54, 76.58it/s]Running loglikelihood requests:  76%|███████▌  | 12673/16732 [04:03<00:52, 76.76it/s]Running loglikelihood requests:  77%|███████▋  | 12801/16732 [04:05<00:51, 76.92it/s]Running loglikelihood requests:  77%|███████▋  | 12929/16732 [04:06<00:49, 77.04it/s]Running loglikelihood requests:  78%|███████▊  | 13057/16732 [04:08<00:47, 77.21it/s]Running loglikelihood requests:  79%|███████▉  | 13185/16732 [04:10<00:45, 77.33it/s]Running loglikelihood requests:  80%|███████▉  | 13313/16732 [04:11<00:44, 77.47it/s]Running loglikelihood requests:  80%|████████  | 13441/16732 [04:13<00:42, 77.45it/s]Running loglikelihood requests:  81%|████████  | 13569/16732 [04:15<00:40, 77.65it/s]Running loglikelihood requests:  82%|████████▏ | 13697/16732 [04:16<00:39, 77.80it/s]Running loglikelihood requests:  83%|████████▎ | 13825/16732 [04:18<00:37, 78.38it/s]Running loglikelihood requests:  83%|████████▎ | 13953/16732 [04:19<00:35, 78.79it/s]Running loglikelihood requests:  84%|████████▍ | 14081/16732 [04:21<00:33, 79.14it/s]Running loglikelihood requests:  85%|████████▍ | 14209/16732 [04:23<00:31, 79.44it/s]Running loglikelihood requests:  86%|████████▌ | 14337/16732 [04:24<00:29, 79.90it/s]Running loglikelihood requests:  86%|████████▋ | 14465/16732 [04:26<00:28, 80.24it/s]Running loglikelihood requests:  87%|████████▋ | 14593/16732 [04:27<00:26, 80.56it/s]Running loglikelihood requests:  88%|████████▊ | 14721/16732 [04:29<00:24, 80.78it/s]Running loglikelihood requests:  89%|████████▊ | 14849/16732 [04:30<00:23, 81.00it/s]Running loglikelihood requests:  90%|████████▉ | 14977/16732 [04:32<00:21, 81.47it/s]Running loglikelihood requests:  90%|█████████ | 15105/16732 [04:34<00:19, 81.88it/s]Running loglikelihood requests:  91%|█████████ | 15233/16732 [04:35<00:18, 82.27it/s]Running loglikelihood requests:  92%|█████████▏| 15361/16732 [04:37<00:16, 82.75it/s]Running loglikelihood requests:  93%|█████████▎| 15489/16732 [04:38<00:14, 83.07it/s]Running loglikelihood requests:  93%|█████████▎| 15617/16732 [04:40<00:13, 83.34it/s]Running loglikelihood requests:  94%|█████████▍| 15745/16732 [04:41<00:11, 83.59it/s]Running loglikelihood requests:  95%|█████████▍| 15873/16732 [04:43<00:10, 84.39it/s]Running loglikelihood requests:  96%|█████████▌| 16001/16732 [04:44<00:08, 85.19it/s]Running loglikelihood requests:  96%|█████████▋| 16129/16732 [04:46<00:06, 86.16it/s]Running loglikelihood requests:  97%|█████████▋| 16257/16732 [04:47<00:05, 86.95it/s]Running loglikelihood requests:  98%|█████████▊| 16385/16732 [04:48<00:03, 87.74it/s]Running loglikelihood requests:  99%|█████████▊| 16513/16732 [04:50<00:02, 88.80it/s]Running loglikelihood requests:  99%|█████████▉| 16641/16732 [04:51<00:00, 98.26it/s]Running loglikelihood requests: 100%|██████████| 16732/16732 [04:51<00:00, 57.43it/s]
2024-10-30:18:12:15,148 WARNING  [huggingface.py:1353] Failed to get model SHA for /mnt/dg_tunning/lora4_meditron_7b at revision main. Error: Repo id must be in the form 'repo_name' or 'namespace/repo_name': '/mnt/dg_tunning/lora4_meditron_7b'. Use `repo_type` argument if needed.
2024-10-30:18:12:18,268 INFO     [evaluation_tracker.py:269] Output path not provided, skipping saving results aggregated
Passed argument batch_size = auto:1. Detecting largest batch size
Determined largest batch size: 32
hf (pretrained=epfl-llm/meditron-7b,dtype=float16,low_cpu_mem_usage=True,trust_remote_code=True,peft=/mnt/dg_tunning/lora4_meditron_7b), gen_kwargs: (None), limit: None, num_fewshot: 3, batch_size: auto (32)
| Tasks |Version|Filter|n-shot| Metric |   |Value |   |Stderr|
|-------|-------|------|-----:|--------|---|-----:|---|-----:|
|medmcqa|Yaml   |none  |     3|acc     |↑  |0.3459|±  |0.0074|
|       |       |none  |     3|acc_norm|↑  |0.3459|±  |0.0074|

