W1217 01:56:13.911000 1252489 site-packages/torch/distributed/run.py:793] 
W1217 01:56:13.911000 1252489 site-packages/torch/distributed/run.py:793] *****************************************
W1217 01:56:13.911000 1252489 site-packages/torch/distributed/run.py:793] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1217 01:56:13.911000 1252489 site-packages/torch/distributed/run.py:793] *****************************************
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:17,  5.68s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:17,  5.69s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:17,  5.84s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:20,  6.95s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:11<00:11,  5.84s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:11<00:11,  5.82s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:11<00:11,  5.96s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:12<00:12,  6.07s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:17<00:05,  5.77s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:17<00:05,  5.82s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:17<00:05,  5.89s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:17<00:05,  5.77s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:18<00:00,  4.03s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:18<00:00,  4.67s/it]
/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/transformers/training_args.py:1575: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Loading checkpoint shards: 100%|██████████| 4/4 [00:18<00:00,  4.07s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:18<00:00,  4.70s/it]
/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/transformers/training_args.py:1575: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Loading checkpoint shards: 100%|██████████| 4/4 [00:19<00:00,  4.11s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:19<00:00,  4.77s/it]
/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/transformers/training_args.py:1575: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Loading checkpoint shards: 100%|██████████| 4/4 [00:19<00:00,  4.00s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:19<00:00,  4.78s/it]
/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/transformers/training_args.py:1575: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
/playpen/xinyu/jesse/dg_tunning/tune_umls.py:144: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
/playpen/xinyu/jesse/dg_tunning/tune_umls.py:144: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
/playpen/xinyu/jesse/dg_tunning/tune_umls.py:144: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
/playpen/xinyu/jesse/dg_tunning/tune_umls.py:144: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
wandb: WARNING The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: 3462549506. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /playpen/xinyu/jesse/dg_tunning/wandb/run-20241217_015705-quzo2msv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ./llama_qa_results
wandb: ⭐️ View project at https://wandb.ai/3462549506/huggingface
wandb: 🚀 View run at https://wandb.ai/3462549506/huggingface/runs/quzo2msv
  0%|          | 0/858 [00:00<?, ?it/s]/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/torch/autograd/graph.py:825: UserWarning: cuDNN SDPA backward got grad_output.strides() != output.strides(), attempting to materialize a grad_output with matching strides... (Triggered internally at ../aten/src/ATen/native/cudnn/MHA.cpp:674.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/torch/autograd/graph.py:825: UserWarning: cuDNN SDPA backward got grad_output.strides() != output.strides(), attempting to materialize a grad_output with matching strides... (Triggered internally at ../aten/src/ATen/native/cudnn/MHA.cpp:674.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/torch/autograd/graph.py:825: UserWarning: cuDNN SDPA backward got grad_output.strides() != output.strides(), attempting to materialize a grad_output with matching strides... (Triggered internally at ../aten/src/ATen/native/cudnn/MHA.cpp:674.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/torch/autograd/graph.py:825: UserWarning: cuDNN SDPA backward got grad_output.strides() != output.strides(), attempting to materialize a grad_output with matching strides... (Triggered internally at ../aten/src/ATen/native/cudnn/MHA.cpp:674.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
  0%|          | 1/858 [00:11<2:49:42, 11.88s/it]  0%|          | 2/858 [00:22<2:36:40, 10.98s/it]  0%|          | 3/858 [00:32<2:32:31, 10.70s/it]  0%|          | 4/858 [00:42<2:30:20, 10.56s/it]  1%|          | 5/858 [00:53<2:29:06, 10.49s/it]  1%|          | 6/858 [01:03<2:28:15, 10.44s/it]  1%|          | 7/858 [01:13<2:27:35, 10.41s/it]  1%|          | 8/858 [01:24<2:27:04, 10.38s/it]  1%|          | 9/858 [01:34<2:26:46, 10.37s/it]  1%|          | 10/858 [01:45<2:26:29, 10.36s/it]  1%|▏         | 11/858 [01:55<2:26:16, 10.36s/it]  1%|▏         | 12/858 [02:05<2:26:04, 10.36s/it]  2%|▏         | 13/858 [02:16<2:25:50, 10.36s/it]  2%|▏         | 14/858 [02:26<2:25:38, 10.35s/it]  2%|▏         | 15/858 [02:36<2:25:27, 10.35s/it]  2%|▏         | 16/858 [02:47<2:25:13, 10.35s/it]  2%|▏         | 17/858 [02:57<2:25:07, 10.35s/it]  2%|▏         | 18/858 [03:07<2:24:56, 10.35s/it]  2%|▏         | 19/858 [03:18<2:24:42, 10.35s/it]  2%|▏         | 20/858 [03:28<2:24:31, 10.35s/it]  2%|▏         | 21/858 [03:38<2:24:21, 10.35s/it]  3%|▎         | 22/858 [03:49<2:24:13, 10.35s/it]  3%|▎         | 23/858 [03:59<2:24:08, 10.36s/it]  3%|▎         | 24/858 [04:09<2:23:55, 10.35s/it]  3%|▎         | 25/858 [04:20<2:23:44, 10.35s/it]  3%|▎         | 26/858 [04:30<2:23:32, 10.35s/it]  3%|▎         | 27/858 [04:40<2:23:21, 10.35s/it]  3%|▎         | 28/858 [04:51<2:24:01, 10.41s/it]  3%|▎         | 29/858 [05:03<2:29:28, 10.82s/it]  3%|▎         | 30/858 [05:13<2:27:17, 10.67s/it]  4%|▎         | 31/858 [05:24<2:26:31, 10.63s/it]  4%|▎         | 32/858 [05:38<2:40:39, 11.67s/it]  4%|▍         | 33/858 [05:48<2:34:53, 11.26s/it]  4%|▍         | 34/858 [05:58<2:30:46, 10.98s/it]  4%|▍         | 35/858 [06:09<2:27:51, 10.78s/it]  4%|▍         | 36/858 [06:19<2:25:41, 10.63s/it]  4%|▍         | 37/858 [06:29<2:24:08, 10.53s/it]  4%|▍         | 38/858 [06:40<2:23:03, 10.47s/it]  5%|▍         | 39/858 [06:50<2:22:13, 10.42s/it]  5%|▍         | 40/858 [07:00<2:21:39, 10.39s/it]  5%|▍         | 41/858 [07:11<2:21:06, 10.36s/it]  5%|▍         | 42/858 [07:21<2:20:45, 10.35s/it]  5%|▌         | 43/858 [07:31<2:20:26, 10.34s/it]  5%|▌         | 44/858 [07:42<2:20:11, 10.33s/it]  5%|▌         | 45/858 [07:52<2:19:54, 10.33s/it]  5%|▌         | 46/858 [08:02<2:19:39, 10.32s/it]  5%|▌         | 47/858 [08:12<2:19:28, 10.32s/it]  6%|▌         | 48/858 [08:23<2:19:13, 10.31s/it]  6%|▌         | 49/858 [08:33<2:18:57, 10.31s/it]  6%|▌         | 50/858 [08:43<2:18:46, 10.31s/it]  6%|▌         | 51/858 [08:54<2:18:34, 10.30s/it]  6%|▌         | 52/858 [09:04<2:18:24, 10.30s/it]  6%|▌         | 53/858 [09:14<2:18:15, 10.31s/it]  6%|▋         | 54/858 [09:25<2:18:04, 10.30s/it]  6%|▋         | 55/858 [09:35<2:17:53, 10.30s/it]  7%|▋         | 56/858 [09:45<2:17:47, 10.31s/it]  7%|▋         | 57/858 [09:55<2:17:38, 10.31s/it]  7%|▋         | 58/858 [10:06<2:17:29, 10.31s/it]  7%|▋         | 59/858 [10:16<2:17:20, 10.31s/it]  7%|▋         | 60/858 [10:27<2:17:33, 10.34s/it]  7%|▋         | 61/858 [10:39<2:24:30, 10.88s/it]  7%|▋         | 62/858 [10:51<2:29:34, 11.27s/it]  7%|▋         | 63/858 [11:01<2:25:32, 10.98s/it]  7%|▋         | 64/858 [11:11<2:22:43, 10.79s/it]  8%|▊         | 65/858 [11:22<2:20:37, 10.64s/it]  8%|▊         | 66/858 [11:32<2:19:11, 10.54s/it]  8%|▊         | 67/858 [11:42<2:18:00, 10.47s/it]  8%|▊         | 68/858 [11:53<2:17:11, 10.42s/it]  8%|▊         | 69/858 [12:03<2:16:33, 10.38s/it]  8%|▊         | 70/858 [12:13<2:16:06, 10.36s/it]  8%|▊         | 71/858 [12:24<2:15:45, 10.35s/it]  8%|▊         | 72/858 [12:34<2:15:24, 10.34s/it]  9%|▊         | 73/858 [12:44<2:15:06, 10.33s/it]  9%|▊         | 74/858 [12:55<2:14:52, 10.32s/it]  9%|▊         | 75/858 [13:05<2:14:39, 10.32s/it]  9%|▉         | 76/858 [13:15<2:14:27, 10.32s/it]  9%|▉         | 77/858 [13:25<2:14:15, 10.31s/it]  9%|▉         | 78/858 [13:36<2:14:02, 10.31s/it]  9%|▉         | 79/858 [13:46<2:13:53, 10.31s/it]  9%|▉         | 80/858 [13:56<2:13:46, 10.32s/it]  9%|▉         | 81/858 [14:07<2:14:14, 10.37s/it] 10%|▉         | 82/858 [14:20<2:23:41, 11.11s/it] 10%|▉         | 83/858 [14:31<2:24:23, 11.18s/it] 10%|▉         | 84/858 [14:41<2:20:50, 10.92s/it] 10%|▉         | 85/858 [14:52<2:18:19, 10.74s/it] 10%|█         | 86/858 [15:02<2:16:28, 10.61s/it] 10%|█         | 87/858 [15:12<2:15:06, 10.51s/it] 10%|█         | 88/858 [15:23<2:14:06, 10.45s/it] 10%|█         | 89/858 [15:33<2:13:25, 10.41s/it] 10%|█         | 90/858 [15:43<2:12:53, 10.38s/it] 11%|█         | 91/858 [15:54<2:12:25, 10.36s/it] 11%|█         | 92/858 [16:04<2:12:01, 10.34s/it] 11%|█         | 93/858 [16:14<2:11:45, 10.33s/it] 11%|█         | 94/858 [16:24<2:11:31, 10.33s/it] 11%|█         | 95/858 [16:35<2:11:29, 10.34s/it] 11%|█         | 96/858 [16:45<2:11:11, 10.33s/it] 11%|█▏        | 97/858 [16:55<2:10:54, 10.32s/it] 11%|█▏        | 98/858 [17:06<2:10:39, 10.32s/it] 12%|█▏        | 99/858 [17:16<2:10:25, 10.31s/it] 12%|█▏        | 100/858 [17:26<2:10:16, 10.31s/it]                                                   {'loss': 78.4474, 'grad_norm': nan, 'learning_rate': 1.9983775409361447e-05, 'epoch': 0.35}
 12%|█▏        | 100/858 [17:26<2:10:16, 10.31s/it] 12%|█▏        | 101/858 [17:37<2:10:07, 10.31s/it] 12%|█▏        | 102/858 [17:47<2:09:55, 10.31s/it] 12%|█▏        | 103/858 [17:57<2:09:40, 10.30s/it] 12%|█▏        | 104/858 [18:08<2:09:27, 10.30s/it] 12%|█▏        | 105/858 [18:18<2:09:21, 10.31s/it] 12%|█▏        | 106/858 [18:28<2:09:10, 10.31s/it] 12%|█▏        | 107/858 [18:39<2:08:59, 10.31s/it] 13%|█▎        | 108/858 [18:49<2:09:07, 10.33s/it] 13%|█▎        | 109/858 [18:59<2:08:50, 10.32s/it] 13%|█▎        | 110/858 [19:10<2:08:38, 10.32s/it] 13%|█▎        | 111/858 [19:20<2:08:28, 10.32s/it] 13%|█▎        | 112/858 [19:30<2:08:15, 10.32s/it] 13%|█▎        | 113/858 [19:40<2:08:02, 10.31s/it] 13%|█▎        | 114/858 [19:51<2:07:52, 10.31s/it] 13%|█▎        | 115/858 [20:01<2:07:38, 10.31s/it] 14%|█▎        | 116/858 [20:11<2:07:24, 10.30s/it] 14%|█▎        | 117/858 [20:22<2:07:17, 10.31s/it] 14%|█▍        | 118/858 [20:32<2:07:05, 10.30s/it] 14%|█▍        | 119/858 [20:42<2:06:59, 10.31s/it] 14%|█▍        | 120/858 [20:53<2:06:47, 10.31s/it] 14%|█▍        | 121/858 [21:03<2:06:36, 10.31s/it] 14%|█▍        | 122/858 [21:13<2:06:24, 10.31s/it] 14%|█▍        | 123/858 [21:23<2:06:11, 10.30s/it] 14%|█▍        | 124/858 [21:34<2:06:07, 10.31s/it] 15%|█▍        | 125/858 [21:44<2:05:56, 10.31s/it] 15%|█▍        | 126/858 [21:54<2:05:44, 10.31s/it] 15%|█▍        | 127/858 [22:05<2:05:35, 10.31s/it] 15%|█▍        | 128/858 [22:15<2:05:25, 10.31s/it] 15%|█▌        | 129/858 [22:25<2:05:13, 10.31s/it] 15%|█▌        | 130/858 [22:36<2:05:03, 10.31s/it] 15%|█▌        | 131/858 [22:46<2:04:55, 10.31s/it] 15%|█▌        | 132/858 [22:56<2:04:46, 10.31s/it] 16%|█▌        | 133/858 [23:07<2:04:34, 10.31s/it] 16%|█▌        | 134/858 [23:17<2:04:21, 10.31s/it] 16%|█▌        | 135/858 [23:27<2:04:12, 10.31s/it] 16%|█▌        | 136/858 [23:38<2:04:01, 10.31s/it] 16%|█▌        | 137/858 [23:48<2:03:49, 10.30s/it] 16%|█▌        | 138/858 [23:58<2:03:40, 10.31s/it] 16%|█▌        | 139/858 [24:08<2:03:29, 10.31s/it] 16%|█▋        | 140/858 [24:19<2:03:21, 10.31s/it] 16%|█▋        | 141/858 [24:29<2:03:10, 10.31s/it] 17%|█▋        | 142/858 [24:39<2:02:55, 10.30s/it] 17%|█▋        | 143/858 [24:50<2:02:46, 10.30s/it] 17%|█▋        | 144/858 [25:00<2:02:34, 10.30s/it] 17%|█▋        | 145/858 [25:10<2:02:26, 10.30s/it] 17%|█▋        | 146/858 [25:21<2:02:58, 10.36s/it] 17%|█▋        | 147/858 [25:33<2:08:27, 10.84s/it] 17%|█▋        | 148/858 [25:43<2:06:21, 10.68s/it] 17%|█▋        | 149/858 [25:54<2:05:35, 10.63s/it] 17%|█▋        | 150/858 [26:08<2:17:30, 11.65s/it] 18%|█▊        | 151/858 [26:18<2:12:32, 11.25s/it] 18%|█▊        | 152/858 [26:28<2:09:03, 10.97s/it] 18%|█▊        | 153/858 [26:38<2:06:33, 10.77s/it] 18%|█▊        | 154/858 [26:49<2:04:46, 10.63s/it] 18%|█▊        | 155/858 [26:59<2:03:28, 10.54s/it] 18%|█▊        | 156/858 [27:09<2:02:29, 10.47s/it] 18%|█▊        | 157/858 [27:20<2:01:48, 10.43s/it] 18%|█▊        | 158/858 [27:30<2:01:15, 10.39s/it] 19%|█▊        | 159/858 [27:40<2:00:47, 10.37s/it] 19%|█▊        | 160/858 [27:51<2:00:23, 10.35s/it] 19%|█▉        | 161/858 [28:01<2:00:03, 10.34s/it] 19%|█▉        | 162/858 [28:11<1:59:49, 10.33s/it] 19%|█▉        | 163/858 [28:22<1:59:37, 10.33s/it] 19%|█▉        | 164/858 [28:32<1:59:26, 10.33s/it] 19%|█▉        | 165/858 [28:42<1:59:14, 10.32s/it] 19%|█▉        | 166/858 [28:53<1:59:06, 10.33s/it] 19%|█▉        | 167/858 [29:03<1:58:51, 10.32s/it] 20%|█▉        | 168/858 [29:13<1:58:38, 10.32s/it] 20%|█▉        | 169/858 [29:24<1:58:25, 10.31s/it] 20%|█▉        | 170/858 [29:34<1:58:16, 10.32s/it] 20%|█▉        | 171/858 [29:44<1:58:07, 10.32s/it] 20%|██        | 172/858 [29:54<1:57:56, 10.32s/it] 20%|██        | 173/858 [30:05<1:57:44, 10.31s/it] 20%|██        | 174/858 [30:15<1:57:36, 10.32s/it] 20%|██        | 175/858 [30:25<1:57:25, 10.32s/it] 21%|██        | 176/858 [30:36<1:57:15, 10.32s/it] 21%|██        | 177/858 [30:46<1:57:06, 10.32s/it] 21%|██        | 178/858 [30:56<1:56:55, 10.32s/it] 21%|██        | 179/858 [31:07<1:56:40, 10.31s/it] 21%|██        | 180/858 [31:17<1:56:33, 10.31s/it] 21%|██        | 181/858 [31:27<1:56:20, 10.31s/it] 21%|██        | 182/858 [31:38<1:56:09, 10.31s/it] 21%|██▏       | 183/858 [31:48<1:56:00, 10.31s/it] 21%|██▏       | 184/858 [31:58<1:55:48, 10.31s/it] 22%|██▏       | 185/858 [32:09<1:55:39, 10.31s/it] 22%|██▏       | 186/858 [32:19<1:55:28, 10.31s/it] 22%|██▏       | 187/858 [32:29<1:55:17, 10.31s/it] 22%|██▏       | 188/858 [32:39<1:55:05, 10.31s/it] 22%|██▏       | 189/858 [32:50<1:54:56, 10.31s/it] 22%|██▏       | 190/858 [33:00<1:54:44, 10.31s/it] 22%|██▏       | 191/858 [33:10<1:54:35, 10.31s/it] 22%|██▏       | 192/858 [33:21<1:54:26, 10.31s/it] 22%|██▏       | 193/858 [33:31<1:54:19, 10.32s/it] 23%|██▎       | 194/858 [33:41<1:54:06, 10.31s/it] 23%|██▎       | 195/858 [33:52<1:53:55, 10.31s/it] 23%|██▎       | 196/858 [34:02<1:53:48, 10.31s/it] 23%|██▎       | 197/858 [34:12<1:53:37, 10.31s/it] 23%|██▎       | 198/858 [34:23<1:53:23, 10.31s/it] 23%|██▎       | 199/858 [34:33<1:53:08, 10.30s/it] 23%|██▎       | 200/858 [34:43<1:52:58, 10.30s/it]                                                   {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.8943080519551108e-05, 'epoch': 0.7}
 23%|██▎       | 200/858 [34:43<1:52:58, 10.30s/it] 23%|██▎       | 201/858 [34:53<1:52:50, 10.31s/it] 24%|██▎       | 202/858 [35:04<1:52:36, 10.30s/it] 24%|██▎       | 203/858 [35:14<1:52:28, 10.30s/it] 24%|██▍       | 204/858 [35:24<1:52:18, 10.30s/it] 24%|██▍       | 205/858 [35:35<1:52:10, 10.31s/it] 24%|██▍       | 206/858 [35:45<1:52:02, 10.31s/it] 24%|██▍       | 207/858 [35:55<1:51:54, 10.31s/it] 24%|██▍       | 208/858 [36:06<1:51:42, 10.31s/it] 24%|██▍       | 209/858 [36:16<1:51:35, 10.32s/it] 24%|██▍       | 210/858 [36:26<1:51:25, 10.32s/it] 25%|██▍       | 211/858 [36:37<1:51:21, 10.33s/it] 25%|██▍       | 212/858 [36:47<1:51:07, 10.32s/it] 25%|██▍       | 213/858 [36:57<1:50:55, 10.32s/it] 25%|██▍       | 214/858 [37:08<1:50:44, 10.32s/it] 25%|██▌       | 215/858 [37:18<1:50:31, 10.31s/it] 25%|██▌       | 216/858 [37:28<1:50:17, 10.31s/it] 25%|██▌       | 217/858 [37:38<1:50:07, 10.31s/it] 25%|██▌       | 218/858 [37:49<1:49:54, 10.30s/it] 26%|██▌       | 219/858 [37:59<1:49:44, 10.30s/it] 26%|██▌       | 220/858 [38:09<1:49:35, 10.31s/it] 26%|██▌       | 221/858 [38:20<1:49:24, 10.30s/it] 26%|██▌       | 222/858 [38:30<1:49:14, 10.31s/it] 26%|██▌       | 223/858 [38:40<1:49:07, 10.31s/it] 26%|██▌       | 224/858 [38:51<1:48:57, 10.31s/it] 26%|██▌       | 225/858 [39:01<1:48:45, 10.31s/it] 26%|██▋       | 226/858 [39:11<1:48:37, 10.31s/it] 26%|██▋       | 227/858 [39:22<1:48:27, 10.31s/it] 27%|██▋       | 228/858 [39:32<1:48:18, 10.31s/it] 27%|██▋       | 229/858 [39:42<1:48:09, 10.32s/it] 27%|██▋       | 230/858 [39:53<1:47:57, 10.31s/it] 27%|██▋       | 231/858 [40:03<1:47:52, 10.32s/it] 27%|██▋       | 232/858 [40:13<1:47:41, 10.32s/it] 27%|██▋       | 233/858 [40:23<1:47:28, 10.32s/it] 27%|██▋       | 234/858 [40:34<1:47:19, 10.32s/it] 27%|██▋       | 235/858 [40:44<1:47:07, 10.32s/it] 28%|██▊       | 236/858 [40:54<1:46:56, 10.32s/it] 28%|██▊       | 237/858 [41:05<1:46:58, 10.34s/it] 28%|██▊       | 238/858 [41:15<1:46:43, 10.33s/it] 28%|██▊       | 239/858 [41:25<1:46:31, 10.32s/it] 28%|██▊       | 240/858 [41:36<1:46:20, 10.32s/it] 28%|██▊       | 241/858 [41:46<1:46:05, 10.32s/it] 28%|██▊       | 242/858 [41:56<1:45:55, 10.32s/it] 28%|██▊       | 243/858 [42:07<1:45:45, 10.32s/it] 28%|██▊       | 244/858 [42:17<1:45:34, 10.32s/it] 29%|██▊       | 245/858 [42:27<1:45:23, 10.31s/it] 29%|██▊       | 246/858 [42:38<1:45:10, 10.31s/it] 29%|██▉       | 247/858 [42:48<1:45:01, 10.31s/it] 29%|██▉       | 248/858 [42:58<1:44:49, 10.31s/it] 29%|██▉       | 249/858 [43:09<1:44:35, 10.30s/it] 29%|██▉       | 250/858 [43:19<1:44:26, 10.31s/it] 29%|██▉       | 251/858 [43:29<1:44:17, 10.31s/it] 29%|██▉       | 252/858 [43:39<1:44:06, 10.31s/it] 29%|██▉       | 253/858 [43:50<1:43:56, 10.31s/it] 30%|██▉       | 254/858 [44:00<1:43:44, 10.31s/it] 30%|██▉       | 255/858 [44:10<1:43:34, 10.31s/it] 30%|██▉       | 256/858 [44:21<1:43:23, 10.31s/it] 30%|██▉       | 257/858 [44:31<1:43:14, 10.31s/it] 30%|███       | 258/858 [44:41<1:43:03, 10.31s/it] 30%|███       | 259/858 [44:52<1:42:51, 10.30s/it] 30%|███       | 260/858 [45:02<1:42:39, 10.30s/it] 30%|███       | 261/858 [45:12<1:42:28, 10.30s/it] 31%|███       | 262/858 [45:22<1:42:16, 10.30s/it] 31%|███       | 263/858 [45:33<1:42:10, 10.30s/it] 31%|███       | 264/858 [45:43<1:42:00, 10.30s/it] 31%|███       | 265/858 [45:53<1:41:51, 10.31s/it] 31%|███       | 266/858 [46:04<1:41:42, 10.31s/it] 31%|███       | 267/858 [46:14<1:41:31, 10.31s/it] 31%|███       | 268/858 [46:24<1:41:17, 10.30s/it] 31%|███▏      | 269/858 [46:35<1:41:08, 10.30s/it] 31%|███▏      | 270/858 [46:45<1:40:59, 10.30s/it] 32%|███▏      | 271/858 [46:55<1:40:48, 10.30s/it] 32%|███▏      | 272/858 [47:06<1:40:38, 10.30s/it] 32%|███▏      | 273/858 [47:16<1:40:29, 10.31s/it] 32%|███▏      | 274/858 [47:26<1:40:19, 10.31s/it] 32%|███▏      | 275/858 [47:36<1:40:07, 10.30s/it] 32%|███▏      | 276/858 [47:47<1:39:56, 10.30s/it] 32%|███▏      | 277/858 [47:57<1:39:46, 10.30s/it] 32%|███▏      | 278/858 [48:07<1:39:36, 10.30s/it] 33%|███▎      | 279/858 [48:18<1:39:26, 10.30s/it] 33%|███▎      | 280/858 [48:28<1:39:15, 10.30s/it] 33%|███▎      | 281/858 [48:38<1:39:07, 10.31s/it] 33%|███▎      | 282/858 [48:49<1:38:58, 10.31s/it] 33%|███▎      | 283/858 [48:59<1:38:47, 10.31s/it] 33%|███▎      | 284/858 [49:09<1:38:34, 10.30s/it] 33%|███▎      | 285/858 [49:20<1:38:24, 10.30s/it] 33%|███▎      | 286/858 [49:30<1:38:15, 10.31s/it] 33%|███▎      | 287/858 [49:35<1:23:23,  8.76s/it]
  0%|          | 0/64 [00:00<?, ?it/s][A
  3%|▎         | 2/64 [00:02<01:13,  1.18s/it][A
  5%|▍         | 3/64 [00:04<01:41,  1.67s/it][A
  6%|▋         | 4/64 [00:07<01:55,  1.93s/it][A
  8%|▊         | 5/64 [00:09<02:02,  2.08s/it][A
  9%|▉         | 6/64 [00:11<02:05,  2.17s/it][A
 11%|█         | 7/64 [00:14<02:07,  2.23s/it][A
 12%|█▎        | 8/64 [00:16<02:07,  2.28s/it][A
 14%|█▍        | 9/64 [00:18<02:06,  2.30s/it][A
 16%|█▌        | 10/64 [00:21<02:05,  2.32s/it][A
 17%|█▋        | 11/64 [00:23<02:03,  2.33s/it][A
 19%|█▉        | 12/64 [00:25<02:01,  2.34s/it][A
 20%|██        | 13/64 [00:28<01:59,  2.35s/it][A
 22%|██▏       | 14/64 [00:30<01:57,  2.36s/it][A
 23%|██▎       | 15/64 [00:33<01:55,  2.36s/it][A
 25%|██▌       | 16/64 [00:35<01:53,  2.36s/it][A
 27%|██▋       | 17/64 [00:37<01:50,  2.36s/it][A
 28%|██▊       | 18/64 [00:40<01:48,  2.36s/it][A
 30%|██▉       | 19/64 [00:42<01:46,  2.36s/it][A
 31%|███▏      | 20/64 [00:44<01:44,  2.36s/it][A
 33%|███▎      | 21/64 [00:47<01:41,  2.36s/it][A
 34%|███▍      | 22/64 [00:49<01:39,  2.36s/it][A
 36%|███▌      | 23/64 [00:51<01:36,  2.36s/it][A
 38%|███▊      | 24/64 [00:54<01:34,  2.36s/it][A
 39%|███▉      | 25/64 [00:56<01:32,  2.36s/it][A
 41%|████      | 26/64 [00:59<01:29,  2.36s/it][A
 42%|████▏     | 27/64 [01:01<01:27,  2.36s/it][A
 44%|████▍     | 28/64 [01:03<01:25,  2.36s/it][A
 45%|████▌     | 29/64 [01:06<01:22,  2.36s/it][A
 47%|████▋     | 30/64 [01:08<01:20,  2.36s/it][A
 48%|████▊     | 31/64 [01:10<01:18,  2.36s/it][A
 50%|█████     | 32/64 [01:13<01:15,  2.36s/it][A
 52%|█████▏    | 33/64 [01:15<01:13,  2.36s/it][A
 53%|█████▎    | 34/64 [01:17<01:10,  2.36s/it][A
 55%|█████▍    | 35/64 [01:20<01:08,  2.36s/it][A
 56%|█████▋    | 36/64 [01:22<01:06,  2.36s/it][A
 58%|█████▊    | 37/64 [01:25<01:03,  2.36s/it][A
 59%|█████▉    | 38/64 [01:27<01:01,  2.36s/it][A
 61%|██████    | 39/64 [01:29<00:59,  2.36s/it][A
 62%|██████▎   | 40/64 [01:32<00:56,  2.36s/it][A
 64%|██████▍   | 41/64 [01:34<00:54,  2.36s/it][A
 66%|██████▌   | 42/64 [01:36<00:51,  2.36s/it][A
 67%|██████▋   | 43/64 [01:39<00:49,  2.36s/it][A
 69%|██████▉   | 44/64 [01:41<00:47,  2.36s/it][A
 70%|███████   | 45/64 [01:43<00:44,  2.36s/it][A
 72%|███████▏  | 46/64 [01:46<00:42,  2.36s/it][A
 73%|███████▎  | 47/64 [01:48<00:40,  2.36s/it][A
 75%|███████▌  | 48/64 [01:51<00:37,  2.36s/it][A
 77%|███████▋  | 49/64 [01:53<00:35,  2.36s/it][A
 78%|███████▊  | 50/64 [01:55<00:33,  2.36s/it][A
 80%|███████▉  | 51/64 [01:58<00:30,  2.36s/it][A
 81%|████████▏ | 52/64 [02:00<00:28,  2.36s/it][A
 83%|████████▎ | 53/64 [02:02<00:25,  2.36s/it][A
 84%|████████▍ | 54/64 [02:05<00:23,  2.36s/it][A
 86%|████████▌ | 55/64 [02:07<00:21,  2.36s/it][A
 88%|████████▊ | 56/64 [02:09<00:18,  2.36s/it][A
 89%|████████▉ | 57/64 [02:12<00:16,  2.36s/it][A
 91%|█████████ | 58/64 [02:14<00:14,  2.36s/it][A
 92%|█████████▏| 59/64 [02:17<00:11,  2.36s/it][A
 94%|█████████▍| 60/64 [02:19<00:09,  2.36s/it][A
 95%|█████████▌| 61/64 [02:21<00:07,  2.36s/it][A
 97%|█████████▋| 62/64 [02:24<00:04,  2.37s/it][A
 98%|█████████▊| 63/64 [02:26<00:02,  2.36s/it][A
100%|██████████| 64/64 [02:28<00:00,  2.36s/it][A                                                   
                                               [A{'eval_loss': nan, 'eval_runtime': 151.9181, 'eval_samples_per_second': 6.701, 'eval_steps_per_second': 0.421, 'epoch': 1.0}
 33%|███▎      | 287/858 [52:07<1:23:23,  8.76s/it]
100%|██████████| 64/64 [02:28<00:00,  2.36s/it][A
                                               [A/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
  warnings.warn(
/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
  warnings.warn(
/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
  warnings.warn(
/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
  warnings.warn(
/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/torch/autograd/graph.py:825: UserWarning: cuDNN SDPA backward got grad_output.strides() != output.strides(), attempting to materialize a grad_output with matching strides... (Triggered internally at ../aten/src/ATen/native/cudnn/MHA.cpp:674.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
 34%|███▎      | 288/858 [53:51<13:09:06, 83.06s/it] 34%|███▎      | 289/858 [54:02<9:40:44, 61.24s/it]  34%|███▍      | 290/858 [54:12<7:15:04, 45.96s/it] 34%|███▍      | 291/858 [54:22<5:33:14, 35.26s/it] 34%|███▍      | 292/858 [54:33<4:22:00, 27.78s/it] 34%|███▍      | 293/858 [54:43<3:32:09, 22.53s/it] 34%|███▍      | 294/858 [54:53<2:57:16, 18.86s/it] 34%|███▍      | 295/858 [55:04<2:32:49, 16.29s/it] 34%|███▍      | 296/858 [55:14<2:15:42, 14.49s/it] 35%|███▍      | 297/858 [55:24<2:03:42, 13.23s/it] 35%|███▍      | 298/858 [55:34<1:55:28, 12.37s/it] 35%|███▍      | 299/858 [55:45<1:49:30, 11.75s/it] 35%|███▍      | 300/858 [55:55<1:45:16, 11.32s/it]                                                   {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.644172049599691e-05, 'epoch': 1.05}
 35%|███▍      | 300/858 [55:55<1:45:16, 11.32s/it] 35%|███▌      | 301/858 [56:05<1:42:17, 11.02s/it] 35%|███▌      | 302/858 [56:16<1:40:08, 10.81s/it] 35%|███▌      | 303/858 [56:26<1:38:34, 10.66s/it] 35%|███▌      | 304/858 [56:36<1:37:25, 10.55s/it] 36%|███▌      | 305/858 [56:47<1:36:34, 10.48s/it] 36%|███▌      | 306/858 [56:57<1:35:57, 10.43s/it] 36%|███▌      | 307/858 [57:07<1:35:25, 10.39s/it] 36%|███▌      | 308/858 [57:18<1:35:01, 10.37s/it] 36%|███▌      | 309/858 [57:28<1:34:40, 10.35s/it] 36%|███▌      | 310/858 [57:38<1:34:23, 10.33s/it] 36%|███▌      | 311/858 [57:48<1:34:08, 10.33s/it] 36%|███▋      | 312/858 [57:59<1:33:53, 10.32s/it] 36%|███▋      | 313/858 [58:09<1:33:39, 10.31s/it] 37%|███▋      | 314/858 [58:19<1:33:26, 10.31s/it] 37%|███▋      | 315/858 [58:30<1:33:16, 10.31s/it] 37%|███▋      | 316/858 [58:40<1:33:04, 10.30s/it] 37%|███▋      | 317/858 [58:50<1:32:54, 10.30s/it] 37%|███▋      | 318/858 [59:01<1:32:42, 10.30s/it] 37%|███▋      | 319/858 [59:11<1:32:34, 10.30s/it] 37%|███▋      | 320/858 [59:21<1:32:25, 10.31s/it] 37%|███▋      | 321/858 [59:32<1:32:27, 10.33s/it] 38%|███▊      | 322/858 [59:42<1:32:12, 10.32s/it] 38%|███▊      | 323/858 [59:52<1:31:57, 10.31s/it] 38%|███▊      | 324/858 [1:00:02<1:31:44, 10.31s/it] 38%|███▊      | 325/858 [1:00:13<1:31:33, 10.31s/it] 38%|███▊      | 326/858 [1:00:23<1:31:24, 10.31s/it] 38%|███▊      | 327/858 [1:00:33<1:31:14, 10.31s/it] 38%|███▊      | 328/858 [1:00:44<1:31:04, 10.31s/it] 38%|███▊      | 329/858 [1:00:54<1:30:55, 10.31s/it] 38%|███▊      | 330/858 [1:01:04<1:30:42, 10.31s/it] 39%|███▊      | 331/858 [1:01:15<1:30:33, 10.31s/it] 39%|███▊      | 332/858 [1:01:25<1:30:21, 10.31s/it] 39%|███▉      | 333/858 [1:01:35<1:30:11, 10.31s/it] 39%|███▉      | 334/858 [1:01:46<1:30:02, 10.31s/it] 39%|███▉      | 335/858 [1:01:56<1:29:56, 10.32s/it] 39%|███▉      | 336/858 [1:02:06<1:29:46, 10.32s/it] 39%|███▉      | 337/858 [1:02:17<1:29:33, 10.31s/it] 39%|███▉      | 338/858 [1:02:27<1:29:20, 10.31s/it] 40%|███▉      | 339/858 [1:02:37<1:29:09, 10.31s/it] 40%|███▉      | 340/858 [1:02:47<1:28:58, 10.31s/it] 40%|███▉      | 341/858 [1:02:58<1:28:49, 10.31s/it] 40%|███▉      | 342/858 [1:03:08<1:28:37, 10.30s/it] 40%|███▉      | 343/858 [1:03:18<1:28:24, 10.30s/it] 40%|████      | 344/858 [1:03:29<1:28:16, 10.30s/it] 40%|████      | 345/858 [1:03:39<1:28:07, 10.31s/it] 40%|████      | 346/858 [1:03:49<1:27:57, 10.31s/it] 40%|████      | 347/858 [1:04:00<1:27:45, 10.30s/it] 41%|████      | 348/858 [1:04:10<1:27:37, 10.31s/it] 41%|████      | 349/858 [1:04:20<1:27:26, 10.31s/it] 41%|████      | 350/858 [1:04:31<1:27:19, 10.31s/it] 41%|████      | 351/858 [1:04:41<1:27:08, 10.31s/it] 41%|████      | 352/858 [1:04:51<1:26:58, 10.31s/it] 41%|████      | 353/858 [1:05:01<1:26:48, 10.31s/it] 41%|████▏     | 354/858 [1:05:12<1:26:38, 10.32s/it] 41%|████▏     | 355/858 [1:05:22<1:26:27, 10.31s/it] 41%|████▏     | 356/858 [1:05:32<1:26:15, 10.31s/it] 42%|████▏     | 357/858 [1:05:43<1:26:06, 10.31s/it] 42%|████▏     | 358/858 [1:05:53<1:25:53, 10.31s/it] 42%|████▏     | 359/858 [1:06:03<1:25:42, 10.31s/it] 42%|████▏     | 360/858 [1:06:14<1:25:30, 10.30s/it] 42%|████▏     | 361/858 [1:06:24<1:25:20, 10.30s/it] 42%|████▏     | 362/858 [1:06:34<1:25:10, 10.30s/it] 42%|████▏     | 363/858 [1:06:45<1:25:02, 10.31s/it] 42%|████▏     | 364/858 [1:06:55<1:24:50, 10.30s/it] 43%|████▎     | 365/858 [1:07:05<1:24:40, 10.30s/it] 43%|████▎     | 366/858 [1:07:15<1:24:29, 10.30s/it] 43%|████▎     | 367/858 [1:07:26<1:24:17, 10.30s/it] 43%|████▎     | 368/858 [1:07:36<1:24:07, 10.30s/it] 43%|████▎     | 369/858 [1:07:46<1:23:59, 10.30s/it] 43%|████▎     | 370/858 [1:07:57<1:23:48, 10.30s/it] 43%|████▎     | 371/858 [1:08:07<1:23:37, 10.30s/it] 43%|████▎     | 372/858 [1:08:17<1:23:31, 10.31s/it] 43%|████▎     | 373/858 [1:08:28<1:23:18, 10.31s/it] 44%|████▎     | 374/858 [1:08:38<1:23:06, 10.30s/it] 44%|████▎     | 375/858 [1:08:48<1:22:57, 10.31s/it] 44%|████▍     | 376/858 [1:08:58<1:22:44, 10.30s/it] 44%|████▍     | 377/858 [1:09:09<1:22:36, 10.31s/it] 44%|████▍     | 378/858 [1:09:19<1:22:27, 10.31s/it] 44%|████▍     | 379/858 [1:09:29<1:22:16, 10.31s/it] 44%|████▍     | 380/858 [1:09:40<1:22:16, 10.33s/it] 44%|████▍     | 381/858 [1:09:50<1:22:03, 10.32s/it] 45%|████▍     | 382/858 [1:10:00<1:21:47, 10.31s/it] 45%|████▍     | 383/858 [1:10:11<1:21:36, 10.31s/it] 45%|████▍     | 384/858 [1:10:21<1:21:23, 10.30s/it] 45%|████▍     | 385/858 [1:10:31<1:21:14, 10.31s/it] 45%|████▍     | 386/858 [1:10:42<1:21:04, 10.31s/it] 45%|████▌     | 387/858 [1:10:52<1:20:54, 10.31s/it] 45%|████▌     | 388/858 [1:11:02<1:20:44, 10.31s/it] 45%|████▌     | 389/858 [1:11:13<1:20:35, 10.31s/it] 45%|████▌     | 390/858 [1:11:23<1:20:24, 10.31s/it] 46%|████▌     | 391/858 [1:11:33<1:20:13, 10.31s/it] 46%|████▌     | 392/858 [1:11:43<1:20:02, 10.31s/it] 46%|████▌     | 393/858 [1:11:54<1:19:53, 10.31s/it] 46%|████▌     | 394/858 [1:12:04<1:19:38, 10.30s/it] 46%|████▌     | 395/858 [1:12:14<1:19:29, 10.30s/it] 46%|████▌     | 396/858 [1:12:25<1:19:18, 10.30s/it] 46%|████▋     | 397/858 [1:12:35<1:19:08, 10.30s/it] 46%|████▋     | 398/858 [1:12:45<1:18:58, 10.30s/it] 47%|████▋     | 399/858 [1:12:56<1:18:46, 10.30s/it] 47%|████▋     | 400/858 [1:13:06<1:18:38, 10.30s/it]                                                     {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.2888240175722163e-05, 'epoch': 1.39}
 47%|████▋     | 400/858 [1:13:06<1:18:38, 10.30s/it] 47%|████▋     | 401/858 [1:13:16<1:18:26, 10.30s/it] 47%|████▋     | 402/858 [1:13:26<1:18:16, 10.30s/it] 47%|████▋     | 403/858 [1:13:37<1:18:07, 10.30s/it] 47%|████▋     | 404/858 [1:13:47<1:17:56, 10.30s/it] 47%|████▋     | 405/858 [1:13:57<1:17:47, 10.30s/it] 47%|████▋     | 406/858 [1:14:08<1:17:35, 10.30s/it] 47%|████▋     | 407/858 [1:14:18<1:17:24, 10.30s/it] 48%|████▊     | 408/858 [1:14:28<1:17:16, 10.30s/it] 48%|████▊     | 409/858 [1:14:39<1:17:10, 10.31s/it] 48%|████▊     | 410/858 [1:14:49<1:16:58, 10.31s/it] 48%|████▊     | 411/858 [1:14:59<1:16:50, 10.31s/it] 48%|████▊     | 412/858 [1:15:09<1:16:35, 10.30s/it] 48%|████▊     | 413/858 [1:15:20<1:16:25, 10.31s/it] 48%|████▊     | 414/858 [1:15:30<1:16:14, 10.30s/it] 48%|████▊     | 415/858 [1:15:40<1:16:04, 10.30s/it] 48%|████▊     | 416/858 [1:15:51<1:15:54, 10.30s/it] 49%|████▊     | 417/858 [1:16:01<1:15:44, 10.30s/it] 49%|████▊     | 418/858 [1:16:11<1:15:33, 10.30s/it] 49%|████▉     | 419/858 [1:16:22<1:15:23, 10.30s/it] 49%|████▉     | 420/858 [1:16:32<1:15:13, 10.30s/it] 49%|████▉     | 421/858 [1:16:42<1:15:02, 10.30s/it] 49%|████▉     | 422/858 [1:16:52<1:14:50, 10.30s/it] 49%|████▉     | 423/858 [1:17:03<1:14:40, 10.30s/it] 49%|████▉     | 424/858 [1:17:13<1:14:30, 10.30s/it] 50%|████▉     | 425/858 [1:17:23<1:14:22, 10.31s/it] 50%|████▉     | 426/858 [1:17:34<1:14:12, 10.31s/it] 50%|████▉     | 427/858 [1:17:44<1:14:26, 10.36s/it] 50%|████▉     | 428/858 [1:17:55<1:14:08, 10.34s/it] 50%|█████     | 429/858 [1:18:05<1:13:51, 10.33s/it] 50%|█████     | 430/858 [1:18:15<1:13:38, 10.32s/it] 50%|█████     | 431/858 [1:18:25<1:13:25, 10.32s/it] 50%|█████     | 432/858 [1:18:36<1:13:13, 10.31s/it] 50%|█████     | 433/858 [1:18:46<1:13:01, 10.31s/it] 51%|█████     | 434/858 [1:18:56<1:12:51, 10.31s/it] 51%|█████     | 435/858 [1:19:07<1:12:40, 10.31s/it] 51%|█████     | 436/858 [1:19:17<1:12:29, 10.31s/it] 51%|█████     | 437/858 [1:19:27<1:12:19, 10.31s/it] 51%|█████     | 438/858 [1:19:38<1:12:09, 10.31s/it] 51%|█████     | 439/858 [1:19:48<1:12:05, 10.32s/it] 51%|█████▏    | 440/858 [1:19:58<1:11:52, 10.32s/it] 51%|█████▏    | 441/858 [1:20:09<1:11:39, 10.31s/it] 52%|█████▏    | 442/858 [1:20:19<1:11:26, 10.30s/it] 52%|█████▏    | 443/858 [1:20:29<1:11:14, 10.30s/it] 52%|█████▏    | 444/858 [1:20:39<1:11:03, 10.30s/it] 52%|█████▏    | 445/858 [1:20:50<1:10:55, 10.30s/it] 52%|█████▏    | 446/858 [1:21:00<1:10:48, 10.31s/it] 52%|█████▏    | 447/858 [1:21:10<1:10:37, 10.31s/it] 52%|█████▏    | 448/858 [1:21:21<1:10:27, 10.31s/it] 52%|█████▏    | 449/858 [1:21:31<1:10:14, 10.31s/it] 52%|█████▏    | 450/858 [1:21:41<1:10:04, 10.31s/it] 53%|█████▎    | 451/858 [1:21:52<1:09:53, 10.30s/it] 53%|█████▎    | 452/858 [1:22:02<1:09:43, 10.31s/it] 53%|█████▎    | 453/858 [1:22:12<1:09:33, 10.31s/it] 53%|█████▎    | 454/858 [1:22:22<1:09:23, 10.31s/it] 53%|█████▎    | 455/858 [1:22:33<1:09:12, 10.31s/it] 53%|█████▎    | 456/858 [1:22:43<1:09:02, 10.31s/it] 53%|█████▎    | 457/858 [1:22:53<1:08:52, 10.31s/it] 53%|█████▎    | 458/858 [1:23:04<1:08:41, 10.30s/it] 53%|█████▎    | 459/858 [1:23:14<1:08:31, 10.31s/it] 54%|█████▎    | 460/858 [1:23:24<1:08:21, 10.30s/it] 54%|█████▎    | 461/858 [1:23:35<1:08:10, 10.30s/it] 54%|█████▍    | 462/858 [1:23:45<1:07:59, 10.30s/it] 54%|█████▍    | 463/858 [1:23:55<1:07:49, 10.30s/it] 54%|█████▍    | 464/858 [1:24:06<1:07:38, 10.30s/it] 54%|█████▍    | 465/858 [1:24:16<1:07:28, 10.30s/it] 54%|█████▍    | 466/858 [1:24:26<1:07:17, 10.30s/it] 54%|█████▍    | 467/858 [1:24:36<1:07:08, 10.30s/it] 55%|█████▍    | 468/858 [1:24:47<1:06:57, 10.30s/it] 55%|█████▍    | 469/858 [1:24:57<1:06:47, 10.30s/it] 55%|█████▍    | 470/858 [1:25:07<1:06:36, 10.30s/it] 55%|█████▍    | 471/858 [1:25:18<1:06:25, 10.30s/it] 55%|█████▌    | 472/858 [1:25:28<1:06:15, 10.30s/it] 55%|█████▌    | 473/858 [1:25:38<1:06:04, 10.30s/it] 55%|█████▌    | 474/858 [1:25:49<1:05:54, 10.30s/it] 55%|█████▌    | 475/858 [1:25:59<1:05:44, 10.30s/it] 55%|█████▌    | 476/858 [1:26:09<1:05:35, 10.30s/it] 56%|█████▌    | 477/858 [1:26:19<1:05:25, 10.30s/it] 56%|█████▌    | 478/858 [1:26:30<1:05:14, 10.30s/it] 56%|█████▌    | 479/858 [1:26:40<1:05:02, 10.30s/it] 56%|█████▌    | 480/858 [1:26:50<1:04:53, 10.30s/it] 56%|█████▌    | 481/858 [1:27:01<1:04:43, 10.30s/it] 56%|█████▌    | 482/858 [1:27:11<1:04:32, 10.30s/it] 56%|█████▋    | 483/858 [1:27:21<1:04:25, 10.31s/it] 56%|█████▋    | 484/858 [1:27:32<1:04:14, 10.31s/it] 57%|█████▋    | 485/858 [1:27:42<1:04:04, 10.31s/it] 57%|█████▋    | 486/858 [1:27:52<1:03:54, 10.31s/it] 57%|█████▋    | 487/858 [1:28:02<1:03:42, 10.30s/it] 57%|█████▋    | 488/858 [1:28:13<1:03:31, 10.30s/it] 57%|█████▋    | 489/858 [1:28:23<1:03:20, 10.30s/it] 57%|█████▋    | 490/858 [1:28:33<1:03:09, 10.30s/it] 57%|█████▋    | 491/858 [1:28:44<1:02:59, 10.30s/it] 57%|█████▋    | 492/858 [1:28:54<1:02:47, 10.29s/it] 57%|█████▋    | 493/858 [1:29:04<1:02:36, 10.29s/it] 58%|█████▊    | 494/858 [1:29:15<1:02:26, 10.29s/it] 58%|█████▊    | 495/858 [1:29:25<1:02:16, 10.29s/it] 58%|█████▊    | 496/858 [1:29:35<1:02:06, 10.29s/it] 58%|█████▊    | 497/858 [1:29:45<1:01:55, 10.29s/it] 58%|█████▊    | 498/858 [1:29:56<1:01:50, 10.31s/it] 58%|█████▊    | 499/858 [1:30:06<1:01:39, 10.30s/it] 58%|█████▊    | 500/858 [1:30:16<1:01:28, 10.30s/it]                                                     {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.863026238229869e-06, 'epoch': 1.74}
 58%|█████▊    | 500/858 [1:30:16<1:01:28, 10.30s/it] 58%|█████▊    | 501/858 [1:30:27<1:01:17, 10.30s/it] 59%|█████▊    | 502/858 [1:30:37<1:01:08, 10.31s/it] 59%|█████▊    | 503/858 [1:30:47<1:00:58, 10.30s/it] 59%|█████▊    | 504/858 [1:30:58<1:00:47, 10.30s/it] 59%|█████▉    | 505/858 [1:31:08<1:00:37, 10.30s/it] 59%|█████▉    | 506/858 [1:31:18<1:00:27, 10.30s/it] 59%|█████▉    | 507/858 [1:31:28<1:00:16, 10.30s/it] 59%|█████▉    | 508/858 [1:31:39<1:00:06, 10.30s/it] 59%|█████▉    | 509/858 [1:31:49<59:56, 10.31s/it]   59%|█████▉    | 510/858 [1:31:59<59:48, 10.31s/it] 60%|█████▉    | 511/858 [1:32:10<59:39, 10.31s/it] 60%|█████▉    | 512/858 [1:32:20<59:28, 10.31s/it] 60%|█████▉    | 513/858 [1:32:30<59:17, 10.31s/it] 60%|█████▉    | 514/858 [1:32:41<59:07, 10.31s/it] 60%|██████    | 515/858 [1:32:51<58:55, 10.31s/it] 60%|██████    | 516/858 [1:33:01<58:44, 10.31s/it] 60%|██████    | 517/858 [1:33:12<58:33, 10.30s/it] 60%|██████    | 518/858 [1:33:22<58:21, 10.30s/it] 60%|██████    | 519/858 [1:33:32<58:11, 10.30s/it] 61%|██████    | 520/858 [1:33:42<58:03, 10.31s/it] 61%|██████    | 521/858 [1:33:53<57:53, 10.31s/it] 61%|██████    | 522/858 [1:34:03<57:42, 10.30s/it] 61%|██████    | 523/858 [1:34:13<57:32, 10.31s/it] 61%|██████    | 524/858 [1:34:24<57:22, 10.31s/it] 61%|██████    | 525/858 [1:34:34<57:12, 10.31s/it] 61%|██████▏   | 526/858 [1:34:44<57:01, 10.30s/it] 61%|██████▏   | 527/858 [1:34:55<56:51, 10.31s/it] 62%|██████▏   | 528/858 [1:35:05<56:40, 10.30s/it] 62%|██████▏   | 529/858 [1:35:15<56:30, 10.30s/it] 62%|██████▏   | 530/858 [1:35:25<56:19, 10.30s/it] 62%|██████▏   | 531/858 [1:35:36<56:09, 10.30s/it] 62%|██████▏   | 532/858 [1:35:46<55:58, 10.30s/it] 62%|██████▏   | 533/858 [1:35:56<55:49, 10.31s/it] 62%|██████▏   | 534/858 [1:36:07<55:39, 10.31s/it] 62%|██████▏   | 535/858 [1:36:17<55:27, 10.30s/it] 62%|██████▏   | 536/858 [1:36:27<55:17, 10.30s/it] 63%|██████▎   | 537/858 [1:36:38<55:07, 10.30s/it] 63%|██████▎   | 538/858 [1:36:48<54:57, 10.30s/it] 63%|██████▎   | 539/858 [1:36:58<54:46, 10.30s/it] 63%|██████▎   | 540/858 [1:37:09<54:37, 10.31s/it] 63%|██████▎   | 541/858 [1:37:19<54:27, 10.31s/it] 63%|██████▎   | 542/858 [1:37:29<54:16, 10.31s/it] 63%|██████▎   | 543/858 [1:37:39<54:04, 10.30s/it] 63%|██████▎   | 544/858 [1:37:50<53:55, 10.30s/it] 64%|██████▎   | 545/858 [1:38:00<53:44, 10.30s/it] 64%|██████▎   | 546/858 [1:38:10<53:35, 10.31s/it] 64%|██████▍   | 547/858 [1:38:21<53:24, 10.30s/it] 64%|██████▍   | 548/858 [1:38:31<53:15, 10.31s/it] 64%|██████▍   | 549/858 [1:38:41<53:05, 10.31s/it] 64%|██████▍   | 550/858 [1:38:52<52:55, 10.31s/it] 64%|██████▍   | 551/858 [1:39:02<52:44, 10.31s/it] 64%|██████▍   | 552/858 [1:39:12<52:33, 10.30s/it] 64%|██████▍   | 553/858 [1:39:23<52:23, 10.31s/it] 65%|██████▍   | 554/858 [1:39:33<52:12, 10.31s/it] 65%|██████▍   | 555/858 [1:39:43<52:03, 10.31s/it] 65%|██████▍   | 556/858 [1:39:53<51:54, 10.31s/it] 65%|██████▍   | 557/858 [1:40:04<51:50, 10.33s/it] 65%|██████▌   | 558/858 [1:40:14<51:37, 10.33s/it] 65%|██████▌   | 559/858 [1:40:24<51:25, 10.32s/it] 65%|██████▌   | 560/858 [1:40:35<51:14, 10.32s/it] 65%|██████▌   | 561/858 [1:40:45<51:02, 10.31s/it] 66%|██████▌   | 562/858 [1:40:55<50:53, 10.31s/it] 66%|██████▌   | 563/858 [1:41:06<50:42, 10.31s/it] 66%|██████▌   | 564/858 [1:41:16<50:31, 10.31s/it] 66%|██████▌   | 565/858 [1:41:26<50:22, 10.31s/it] 66%|██████▌   | 566/858 [1:41:37<50:12, 10.32s/it] 66%|██████▌   | 567/858 [1:41:47<50:00, 10.31s/it] 66%|██████▌   | 568/858 [1:41:57<49:49, 10.31s/it] 66%|██████▋   | 569/858 [1:42:08<49:38, 10.31s/it] 66%|██████▋   | 570/858 [1:42:18<49:28, 10.31s/it] 67%|██████▋   | 571/858 [1:42:28<49:18, 10.31s/it] 67%|██████▋   | 572/858 [1:42:38<49:08, 10.31s/it] 67%|██████▋   | 573/858 [1:42:49<48:58, 10.31s/it] 67%|██████▋   | 574/858 [1:42:54<41:28,  8.76s/it]
  0%|          | 0/64 [00:00<?, ?it/s][A
  3%|▎         | 2/64 [00:02<01:13,  1.18s/it][A
  5%|▍         | 3/64 [00:04<01:41,  1.67s/it][A
  6%|▋         | 4/64 [00:07<01:55,  1.93s/it][A
  8%|▊         | 5/64 [00:09<02:02,  2.08s/it][A
  9%|▉         | 6/64 [00:11<02:05,  2.17s/it][A
 11%|█         | 7/64 [00:14<02:07,  2.23s/it][A
 12%|█▎        | 8/64 [00:16<02:07,  2.27s/it][A
 14%|█▍        | 9/64 [00:18<02:06,  2.30s/it][A
 16%|█▌        | 10/64 [00:21<02:05,  2.32s/it][A
 17%|█▋        | 11/64 [00:23<02:03,  2.33s/it][A
 19%|█▉        | 12/64 [00:25<02:01,  2.34s/it][A
 20%|██        | 13/64 [00:28<01:59,  2.35s/it][A
 22%|██▏       | 14/64 [00:30<01:57,  2.35s/it][A
 23%|██▎       | 15/64 [00:33<01:55,  2.36s/it][A
 25%|██▌       | 16/64 [00:35<01:53,  2.36s/it][A
 27%|██▋       | 17/64 [00:37<01:50,  2.36s/it][A
 28%|██▊       | 18/64 [00:40<01:48,  2.36s/it][A
 30%|██▉       | 19/64 [00:42<01:46,  2.36s/it][A
 31%|███▏      | 20/64 [00:44<01:43,  2.36s/it][A
 33%|███▎      | 21/64 [00:47<01:41,  2.36s/it][A
 34%|███▍      | 22/64 [00:49<01:39,  2.36s/it][A
 36%|███▌      | 23/64 [00:51<01:36,  2.36s/it][A
 38%|███▊      | 24/64 [00:54<01:34,  2.36s/it][A
 39%|███▉      | 25/64 [00:56<01:32,  2.36s/it][A
 41%|████      | 26/64 [00:59<01:29,  2.36s/it][A
 42%|████▏     | 27/64 [01:01<01:27,  2.36s/it][A
 44%|████▍     | 28/64 [01:03<01:25,  2.36s/it][A
 45%|████▌     | 29/64 [01:06<01:22,  2.36s/it][A
 47%|████▋     | 30/64 [01:08<01:20,  2.36s/it][A
 48%|████▊     | 31/64 [01:10<01:17,  2.36s/it][A
 50%|█████     | 32/64 [01:13<01:15,  2.36s/it][A
 52%|█████▏    | 33/64 [01:15<01:13,  2.36s/it][A
 53%|█████▎    | 34/64 [01:17<01:10,  2.36s/it][A
 55%|█████▍    | 35/64 [01:20<01:08,  2.36s/it][A
 56%|█████▋    | 36/64 [01:22<01:06,  2.36s/it][A
 58%|█████▊    | 37/64 [01:25<01:03,  2.36s/it][A
 59%|█████▉    | 38/64 [01:27<01:01,  2.36s/it][A
 61%|██████    | 39/64 [01:29<00:59,  2.36s/it][A
 62%|██████▎   | 40/64 [01:32<00:56,  2.36s/it][A
 64%|██████▍   | 41/64 [01:34<00:54,  2.36s/it][A
 66%|██████▌   | 42/64 [01:36<00:52,  2.37s/it][A
 67%|██████▋   | 43/64 [01:39<00:49,  2.36s/it][A
 69%|██████▉   | 44/64 [01:41<00:47,  2.36s/it][A
 70%|███████   | 45/64 [01:43<00:44,  2.36s/it][A
 72%|███████▏  | 46/64 [01:46<00:42,  2.36s/it][A
 73%|███████▎  | 47/64 [01:48<00:40,  2.36s/it][A
 75%|███████▌  | 48/64 [01:51<00:37,  2.36s/it][A
 77%|███████▋  | 49/64 [01:53<00:35,  2.37s/it][A
 78%|███████▊  | 50/64 [01:55<00:33,  2.36s/it][A
 80%|███████▉  | 51/64 [01:58<00:30,  2.36s/it][A
 81%|████████▏ | 52/64 [02:00<00:28,  2.36s/it][A
 83%|████████▎ | 53/64 [02:02<00:25,  2.36s/it][A
 84%|████████▍ | 54/64 [02:05<00:23,  2.36s/it][A
 86%|████████▌ | 55/64 [02:07<00:21,  2.36s/it][A
 88%|████████▊ | 56/64 [02:09<00:18,  2.36s/it][A
 89%|████████▉ | 57/64 [02:12<00:16,  2.36s/it][A
 91%|█████████ | 58/64 [02:14<00:14,  2.36s/it][A
 92%|█████████▏| 59/64 [02:17<00:11,  2.36s/it][A
 94%|█████████▍| 60/64 [02:19<00:09,  2.36s/it][A
 95%|█████████▌| 61/64 [02:21<00:07,  2.36s/it][A
 97%|█████████▋| 62/64 [02:24<00:04,  2.36s/it][A
 98%|█████████▊| 63/64 [02:26<00:02,  2.36s/it][A
100%|██████████| 64/64 [02:28<00:00,  2.36s/it][A                                                   
                                               [A{'eval_loss': nan, 'eval_runtime': 151.5071, 'eval_samples_per_second': 6.719, 'eval_steps_per_second': 0.422, 'epoch': 2.0}
 67%|██████▋   | 574/858 [1:45:25<41:28,  8.76s/it]
100%|██████████| 64/64 [02:28<00:00,  2.36s/it][A
                                               [A/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
  warnings.warn(
/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/torch/autograd/graph.py:825: UserWarning: cuDNN SDPA backward got grad_output.strides() != output.strides(), attempting to materialize a grad_output with matching strides... (Triggered internally at ../aten/src/ATen/native/cudnn/MHA.cpp:674.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
 67%|██████▋   | 575/858 [1:47:11<6:32:22, 83.19s/it] 67%|██████▋   | 576/858 [1:47:21<4:48:13, 61.33s/it] 67%|██████▋   | 577/858 [1:47:31<3:35:32, 46.02s/it] 67%|██████▋   | 578/858 [1:47:42<2:44:48, 35.32s/it] 67%|██████▋   | 579/858 [1:47:52<2:09:19, 27.81s/it] 68%|██████▊   | 580/858 [1:48:02<1:44:32, 22.56s/it] 68%|██████▊   | 581/858 [1:48:13<1:27:10, 18.88s/it] 68%|██████▊   | 582/858 [1:48:23<1:15:01, 16.31s/it] 68%|██████▊   | 583/858 [1:48:33<1:06:29, 14.51s/it] 68%|██████▊   | 584/858 [1:48:44<1:00:31, 13.25s/it] 68%|██████▊   | 585/858 [1:48:54<56:16, 12.37s/it]   68%|██████▊   | 586/858 [1:49:04<53:14, 11.75s/it] 68%|██████▊   | 587/858 [1:49:15<51:06, 11.32s/it] 69%|██████▊   | 588/858 [1:49:25<49:32, 11.01s/it] 69%|██████▊   | 589/858 [1:49:35<48:24, 10.80s/it] 69%|██████▉   | 590/858 [1:49:45<47:34, 10.65s/it] 69%|██████▉   | 591/858 [1:49:56<47:00, 10.56s/it] 69%|██████▉   | 592/858 [1:50:06<46:27, 10.48s/it] 69%|██████▉   | 593/858 [1:50:16<46:02, 10.43s/it] 69%|██████▉   | 594/858 [1:50:27<45:42, 10.39s/it] 69%|██████▉   | 595/858 [1:50:37<45:25, 10.36s/it] 69%|██████▉   | 596/858 [1:50:47<45:09, 10.34s/it] 70%|██████▉   | 597/858 [1:50:58<44:56, 10.33s/it] 70%|██████▉   | 598/858 [1:51:08<44:44, 10.32s/it] 70%|██████▉   | 599/858 [1:51:18<44:32, 10.32s/it] 70%|██████▉   | 600/858 [1:51:28<44:21, 10.32s/it]                                                   {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.02351318178953e-06, 'epoch': 2.09}
 70%|██████▉   | 600/858 [1:51:28<44:21, 10.32s/it] 70%|███████   | 601/858 [1:51:39<44:10, 10.31s/it] 70%|███████   | 602/858 [1:51:49<43:58, 10.31s/it] 70%|███████   | 603/858 [1:51:59<43:48, 10.31s/it] 70%|███████   | 604/858 [1:52:10<43:37, 10.31s/it] 71%|███████   | 605/858 [1:52:20<43:27, 10.31s/it] 71%|███████   | 606/858 [1:52:30<43:17, 10.31s/it] 71%|███████   | 607/858 [1:52:41<43:05, 10.30s/it] 71%|███████   | 608/858 [1:52:51<42:55, 10.30s/it] 71%|███████   | 609/858 [1:53:01<42:46, 10.31s/it] 71%|███████   | 610/858 [1:53:12<42:35, 10.30s/it] 71%|███████   | 611/858 [1:53:22<42:23, 10.30s/it] 71%|███████▏  | 612/858 [1:53:32<42:14, 10.30s/it] 71%|███████▏  | 613/858 [1:53:43<42:29, 10.41s/it] 72%|███████▏  | 614/858 [1:53:53<42:11, 10.38s/it] 72%|███████▏  | 615/858 [1:54:03<41:55, 10.35s/it] 72%|███████▏  | 616/858 [1:54:14<41:42, 10.34s/it] 72%|███████▏  | 617/858 [1:54:24<41:29, 10.33s/it] 72%|███████▏  | 618/858 [1:54:34<41:19, 10.33s/it] 72%|███████▏  | 619/858 [1:54:45<41:08, 10.33s/it] 72%|███████▏  | 620/858 [1:54:55<40:57, 10.32s/it] 72%|███████▏  | 621/858 [1:55:05<40:46, 10.32s/it] 72%|███████▏  | 622/858 [1:55:16<40:34, 10.32s/it] 73%|███████▎  | 623/858 [1:55:26<40:29, 10.34s/it] 73%|███████▎  | 624/858 [1:55:36<40:17, 10.33s/it] 73%|███████▎  | 625/858 [1:55:47<40:06, 10.33s/it] 73%|███████▎  | 626/858 [1:55:57<39:58, 10.34s/it] 73%|███████▎  | 627/858 [1:56:07<39:46, 10.33s/it] 73%|███████▎  | 628/858 [1:56:18<39:35, 10.33s/it] 73%|███████▎  | 629/858 [1:56:28<39:23, 10.32s/it] 73%|███████▎  | 630/858 [1:56:38<39:12, 10.32s/it] 74%|███████▎  | 631/858 [1:56:49<39:01, 10.31s/it] 74%|███████▎  | 632/858 [1:56:59<38:50, 10.31s/it] 74%|███████▍  | 633/858 [1:57:09<38:41, 10.32s/it] 74%|███████▍  | 634/858 [1:57:19<38:30, 10.32s/it] 74%|███████▍  | 635/858 [1:57:30<38:20, 10.32s/it] 74%|███████▍  | 636/858 [1:57:40<38:10, 10.32s/it] 74%|███████▍  | 637/858 [1:57:50<38:01, 10.32s/it] 74%|███████▍  | 638/858 [1:58:01<37:50, 10.32s/it] 74%|███████▍  | 639/858 [1:58:11<37:39, 10.32s/it] 75%|███████▍  | 640/858 [1:58:21<37:28, 10.31s/it] 75%|███████▍  | 641/858 [1:58:32<37:17, 10.31s/it] 75%|███████▍  | 642/858 [1:58:42<37:06, 10.31s/it] 75%|███████▍  | 643/858 [1:58:52<36:56, 10.31s/it] 75%|███████▌  | 644/858 [1:59:03<36:45, 10.31s/it] 75%|███████▌  | 645/858 [1:59:13<36:35, 10.31s/it] 75%|███████▌  | 646/858 [1:59:23<36:25, 10.31s/it] 75%|███████▌  | 647/858 [1:59:33<36:14, 10.30s/it] 76%|███████▌  | 648/858 [1:59:44<36:03, 10.30s/it] 76%|███████▌  | 649/858 [1:59:54<35:53, 10.30s/it] 76%|███████▌  | 650/858 [2:00:04<35:42, 10.30s/it] 76%|███████▌  | 651/858 [2:00:15<35:32, 10.30s/it] 76%|███████▌  | 652/858 [2:00:25<35:22, 10.30s/it] 76%|███████▌  | 653/858 [2:00:35<35:12, 10.30s/it] 76%|███████▌  | 654/858 [2:00:46<35:02, 10.31s/it] 76%|███████▋  | 655/858 [2:00:56<34:56, 10.33s/it] 76%|███████▋  | 656/858 [2:01:06<34:44, 10.32s/it] 77%|███████▋  | 657/858 [2:01:17<34:33, 10.32s/it] 77%|███████▋  | 658/858 [2:01:27<34:22, 10.31s/it] 77%|███████▋  | 659/858 [2:01:37<34:11, 10.31s/it] 77%|███████▋  | 660/858 [2:01:48<34:01, 10.31s/it] 77%|███████▋  | 661/858 [2:01:58<33:50, 10.31s/it] 77%|███████▋  | 662/858 [2:02:08<33:40, 10.31s/it] 77%|███████▋  | 663/858 [2:02:18<33:31, 10.31s/it] 77%|███████▋  | 664/858 [2:02:29<33:21, 10.31s/it] 78%|███████▊  | 665/858 [2:02:39<33:09, 10.31s/it] 78%|███████▊  | 666/858 [2:02:49<32:59, 10.31s/it] 78%|███████▊  | 667/858 [2:03:00<32:48, 10.31s/it] 78%|███████▊  | 668/858 [2:03:10<32:37, 10.30s/it] 78%|███████▊  | 669/858 [2:03:20<32:27, 10.30s/it] 78%|███████▊  | 670/858 [2:03:31<32:18, 10.31s/it] 78%|███████▊  | 671/858 [2:03:41<32:07, 10.31s/it] 78%|███████▊  | 672/858 [2:03:51<31:57, 10.31s/it] 78%|███████▊  | 673/858 [2:04:02<31:47, 10.31s/it] 79%|███████▊  | 674/858 [2:04:12<31:37, 10.31s/it] 79%|███████▊  | 675/858 [2:04:22<31:25, 10.31s/it] 79%|███████▉  | 676/858 [2:04:32<31:15, 10.31s/it] 79%|███████▉  | 677/858 [2:04:43<31:05, 10.31s/it] 79%|███████▉  | 678/858 [2:04:53<30:54, 10.30s/it] 79%|███████▉  | 679/858 [2:05:03<30:43, 10.30s/it] 79%|███████▉  | 680/858 [2:05:14<30:33, 10.30s/it] 79%|███████▉  | 681/858 [2:05:24<30:22, 10.30s/it] 79%|███████▉  | 682/858 [2:05:34<30:11, 10.29s/it] 80%|███████▉  | 683/858 [2:05:45<30:02, 10.30s/it] 80%|███████▉  | 684/858 [2:05:55<29:52, 10.30s/it] 80%|███████▉  | 685/858 [2:06:05<29:42, 10.30s/it] 80%|███████▉  | 686/858 [2:06:15<29:32, 10.31s/it] 80%|████████  | 687/858 [2:06:26<29:24, 10.32s/it] 80%|████████  | 688/858 [2:06:36<29:13, 10.31s/it] 80%|████████  | 689/858 [2:06:46<29:01, 10.31s/it] 80%|████████  | 690/858 [2:06:57<28:51, 10.31s/it] 81%|████████  | 691/858 [2:07:07<28:42, 10.31s/it] 81%|████████  | 692/858 [2:07:17<28:31, 10.31s/it] 81%|████████  | 693/858 [2:07:28<28:20, 10.30s/it] 81%|████████  | 694/858 [2:07:38<28:09, 10.30s/it] 81%|████████  | 695/858 [2:07:48<27:59, 10.30s/it] 81%|████████  | 696/858 [2:07:59<27:48, 10.30s/it] 81%|████████  | 697/858 [2:08:09<27:38, 10.30s/it] 81%|████████▏ | 698/858 [2:08:19<27:27, 10.30s/it] 81%|████████▏ | 699/858 [2:08:29<27:17, 10.30s/it] 82%|████████▏ | 700/858 [2:08:40<27:07, 10.30s/it]                                                   {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.9968051501954676e-06, 'epoch': 2.44}
 82%|████████▏ | 700/858 [2:08:40<27:07, 10.30s/it] 82%|████████▏ | 701/858 [2:08:50<26:57, 10.30s/it] 82%|████████▏ | 702/858 [2:09:00<26:49, 10.32s/it] 82%|████████▏ | 703/858 [2:09:11<26:39, 10.32s/it] 82%|████████▏ | 704/858 [2:09:21<26:28, 10.32s/it] 82%|████████▏ | 705/858 [2:09:31<26:17, 10.31s/it] 82%|████████▏ | 706/858 [2:09:42<26:06, 10.31s/it] 82%|████████▏ | 707/858 [2:09:52<25:56, 10.31s/it] 83%|████████▎ | 708/858 [2:10:02<25:46, 10.31s/it] 83%|████████▎ | 709/858 [2:10:13<25:36, 10.31s/it] 83%|████████▎ | 710/858 [2:10:23<25:25, 10.31s/it] 83%|████████▎ | 711/858 [2:10:33<25:15, 10.31s/it] 83%|████████▎ | 712/858 [2:10:43<25:04, 10.31s/it] 83%|████████▎ | 713/858 [2:10:54<24:54, 10.31s/it] 83%|████████▎ | 714/858 [2:11:04<24:45, 10.31s/it] 83%|████████▎ | 715/858 [2:11:14<24:35, 10.32s/it] 83%|████████▎ | 716/858 [2:11:25<24:24, 10.32s/it] 84%|████████▎ | 717/858 [2:11:35<24:14, 10.31s/it] 84%|████████▎ | 718/858 [2:11:45<24:03, 10.31s/it] 84%|████████▍ | 719/858 [2:11:56<23:54, 10.32s/it] 84%|████████▍ | 720/858 [2:12:06<23:43, 10.32s/it] 84%|████████▍ | 721/858 [2:12:16<23:32, 10.31s/it] 84%|████████▍ | 722/858 [2:12:27<23:22, 10.31s/it] 84%|████████▍ | 723/858 [2:12:37<23:11, 10.31s/it] 84%|████████▍ | 724/858 [2:12:47<23:01, 10.31s/it] 84%|████████▍ | 725/858 [2:12:58<22:51, 10.31s/it] 85%|████████▍ | 726/858 [2:13:08<22:41, 10.31s/it] 85%|████████▍ | 727/858 [2:13:18<22:30, 10.31s/it] 85%|████████▍ | 728/858 [2:13:28<22:21, 10.32s/it] 85%|████████▍ | 729/858 [2:13:39<22:10, 10.31s/it] 85%|████████▌ | 730/858 [2:13:49<21:59, 10.31s/it] 85%|████████▌ | 731/858 [2:13:59<21:48, 10.30s/it] 85%|████████▌ | 732/858 [2:14:10<21:38, 10.30s/it] 85%|████████▌ | 733/858 [2:14:20<21:28, 10.30s/it] 86%|████████▌ | 734/858 [2:14:30<21:18, 10.31s/it] 86%|████████▌ | 735/858 [2:14:41<21:08, 10.31s/it] 86%|████████▌ | 736/858 [2:14:51<20:57, 10.31s/it] 86%|████████▌ | 737/858 [2:15:01<20:46, 10.30s/it] 86%|████████▌ | 738/858 [2:15:12<20:36, 10.30s/it] 86%|████████▌ | 739/858 [2:15:22<20:26, 10.31s/it] 86%|████████▌ | 740/858 [2:15:32<20:16, 10.31s/it] 86%|████████▋ | 741/858 [2:15:42<20:06, 10.31s/it] 86%|████████▋ | 742/858 [2:15:53<19:55, 10.31s/it] 87%|████████▋ | 743/858 [2:16:03<19:45, 10.31s/it] 87%|████████▋ | 744/858 [2:16:13<19:35, 10.31s/it] 87%|████████▋ | 745/858 [2:16:24<19:24, 10.31s/it] 87%|████████▋ | 746/858 [2:16:34<19:14, 10.31s/it] 87%|████████▋ | 747/858 [2:16:44<19:03, 10.30s/it] 87%|████████▋ | 748/858 [2:16:55<18:53, 10.31s/it] 87%|████████▋ | 749/858 [2:17:05<18:43, 10.31s/it] 87%|████████▋ | 750/858 [2:17:15<18:33, 10.31s/it] 88%|████████▊ | 751/858 [2:17:26<18:24, 10.33s/it] 88%|████████▊ | 752/858 [2:17:36<18:14, 10.32s/it] 88%|████████▊ | 753/858 [2:17:46<18:03, 10.32s/it] 88%|████████▊ | 754/858 [2:17:57<17:52, 10.32s/it] 88%|████████▊ | 755/858 [2:18:07<17:41, 10.31s/it] 88%|████████▊ | 756/858 [2:18:17<17:31, 10.31s/it] 88%|████████▊ | 757/858 [2:18:27<17:21, 10.31s/it] 88%|████████▊ | 758/858 [2:18:38<17:10, 10.31s/it] 88%|████████▊ | 759/858 [2:18:48<17:00, 10.31s/it] 89%|████████▊ | 760/858 [2:18:58<16:50, 10.31s/it] 89%|████████▊ | 761/858 [2:19:09<16:40, 10.31s/it] 89%|████████▉ | 762/858 [2:19:19<16:29, 10.31s/it] 89%|████████▉ | 763/858 [2:19:29<16:19, 10.31s/it] 89%|████████▉ | 764/858 [2:19:40<16:08, 10.31s/it] 89%|████████▉ | 765/858 [2:19:50<15:58, 10.30s/it] 89%|████████▉ | 766/858 [2:20:00<15:48, 10.31s/it] 89%|████████▉ | 767/858 [2:20:11<15:37, 10.31s/it] 90%|████████▉ | 768/858 [2:20:21<15:27, 10.31s/it] 90%|████████▉ | 769/858 [2:20:31<15:17, 10.31s/it] 90%|████████▉ | 770/858 [2:20:41<15:07, 10.31s/it] 90%|████████▉ | 771/858 [2:20:52<14:57, 10.32s/it] 90%|████████▉ | 772/858 [2:21:02<14:46, 10.31s/it] 90%|█████████ | 773/858 [2:21:12<14:36, 10.31s/it] 90%|█████████ | 774/858 [2:21:23<14:25, 10.31s/it] 90%|█████████ | 775/858 [2:21:33<14:15, 10.30s/it] 90%|█████████ | 776/858 [2:21:43<14:04, 10.30s/it] 91%|█████████ | 777/858 [2:21:54<13:54, 10.30s/it] 91%|█████████ | 778/858 [2:22:04<13:45, 10.32s/it] 91%|█████████ | 779/858 [2:22:14<13:34, 10.31s/it] 91%|█████████ | 780/858 [2:22:25<13:24, 10.31s/it] 91%|█████████ | 781/858 [2:22:35<13:13, 10.31s/it] 91%|█████████ | 782/858 [2:22:45<13:03, 10.31s/it] 91%|█████████▏| 783/858 [2:22:56<12:54, 10.33s/it] 91%|█████████▏| 784/858 [2:23:06<12:43, 10.32s/it] 91%|█████████▏| 785/858 [2:23:16<12:33, 10.32s/it] 92%|█████████▏| 786/858 [2:23:26<12:22, 10.31s/it] 92%|█████████▏| 787/858 [2:23:37<12:12, 10.31s/it] 92%|█████████▏| 788/858 [2:23:47<12:01, 10.31s/it] 92%|█████████▏| 789/858 [2:23:57<11:51, 10.31s/it] 92%|█████████▏| 790/858 [2:24:08<11:41, 10.31s/it] 92%|█████████▏| 791/858 [2:24:18<11:30, 10.31s/it] 92%|█████████▏| 792/858 [2:24:28<11:20, 10.31s/it] 92%|█████████▏| 793/858 [2:24:39<11:10, 10.31s/it] 93%|█████████▎| 794/858 [2:24:49<10:59, 10.31s/it] 93%|█████████▎| 795/858 [2:24:59<10:49, 10.31s/it] 93%|█████████▎| 796/858 [2:25:10<10:39, 10.31s/it] 93%|█████████▎| 797/858 [2:25:20<10:28, 10.31s/it] 93%|█████████▎| 798/858 [2:25:30<10:18, 10.31s/it] 93%|█████████▎| 799/858 [2:25:41<10:08, 10.31s/it] 93%|█████████▎| 800/858 [2:25:51<09:58, 10.32s/it]                                                   {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.772515884858673e-07, 'epoch': 2.79}
 93%|█████████▎| 800/858 [2:25:51<09:58, 10.32s/it] 93%|█████████▎| 801/858 [2:26:01<09:48, 10.32s/it] 93%|█████████▎| 802/858 [2:26:12<09:37, 10.32s/it] 94%|█████████▎| 803/858 [2:26:22<09:27, 10.32s/it] 94%|█████████▎| 804/858 [2:26:32<09:17, 10.32s/it] 94%|█████████▍| 805/858 [2:26:42<09:06, 10.31s/it] 94%|█████████▍| 806/858 [2:26:53<08:56, 10.31s/it] 94%|█████████▍| 807/858 [2:27:03<08:45, 10.31s/it] 94%|█████████▍| 808/858 [2:27:13<08:35, 10.31s/it] 94%|█████████▍| 809/858 [2:27:24<08:25, 10.31s/it] 94%|█████████▍| 810/858 [2:27:34<08:14, 10.31s/it] 95%|█████████▍| 811/858 [2:27:44<08:04, 10.31s/it] 95%|█████████▍| 812/858 [2:27:55<07:54, 10.31s/it] 95%|█████████▍| 813/858 [2:28:05<07:43, 10.31s/it] 95%|█████████▍| 814/858 [2:28:15<07:33, 10.31s/it] 95%|█████████▍| 815/858 [2:28:26<07:24, 10.33s/it] 95%|█████████▌| 816/858 [2:28:36<07:13, 10.32s/it] 95%|█████████▌| 817/858 [2:28:46<07:03, 10.32s/it] 95%|█████████▌| 818/858 [2:28:57<06:52, 10.32s/it] 95%|█████████▌| 819/858 [2:29:07<06:42, 10.31s/it] 96%|█████████▌| 820/858 [2:29:17<06:31, 10.31s/it] 96%|█████████▌| 821/858 [2:29:27<06:21, 10.31s/it] 96%|█████████▌| 822/858 [2:29:38<06:11, 10.31s/it] 96%|█████████▌| 823/858 [2:29:48<06:01, 10.31s/it] 96%|█████████▌| 824/858 [2:29:58<05:50, 10.31s/it] 96%|█████████▌| 825/858 [2:30:09<05:40, 10.31s/it] 96%|█████████▋| 826/858 [2:30:19<05:30, 10.31s/it] 96%|█████████▋| 827/858 [2:30:29<05:19, 10.31s/it] 97%|█████████▋| 828/858 [2:30:40<05:09, 10.32s/it] 97%|█████████▋| 829/858 [2:30:50<04:59, 10.32s/it] 97%|█████████▋| 830/858 [2:31:00<04:48, 10.31s/it] 97%|█████████▋| 831/858 [2:31:11<04:38, 10.31s/it] 97%|█████████▋| 832/858 [2:31:21<04:28, 10.31s/it] 97%|█████████▋| 833/858 [2:31:31<04:17, 10.31s/it] 97%|█████████▋| 834/858 [2:31:42<04:07, 10.32s/it] 97%|█████████▋| 835/858 [2:31:52<03:57, 10.32s/it] 97%|█████████▋| 836/858 [2:32:02<03:46, 10.31s/it] 98%|█████████▊| 837/858 [2:32:12<03:36, 10.31s/it] 98%|█████████▊| 838/858 [2:32:23<03:26, 10.31s/it] 98%|█████████▊| 839/858 [2:32:33<03:15, 10.31s/it] 98%|█████████▊| 840/858 [2:32:43<03:05, 10.31s/it] 98%|█████████▊| 841/858 [2:32:54<02:55, 10.31s/it] 98%|█████████▊| 842/858 [2:33:04<02:44, 10.31s/it] 98%|█████████▊| 843/858 [2:33:14<02:34, 10.31s/it] 98%|█████████▊| 844/858 [2:33:25<02:24, 10.31s/it] 98%|█████████▊| 845/858 [2:33:35<02:14, 10.31s/it] 99%|█████████▊| 846/858 [2:33:45<02:03, 10.31s/it] 99%|█████████▊| 847/858 [2:33:56<01:53, 10.32s/it] 99%|█████████▉| 848/858 [2:34:06<01:43, 10.31s/it] 99%|█████████▉| 849/858 [2:34:16<01:32, 10.31s/it] 99%|█████████▉| 850/858 [2:34:26<01:22, 10.31s/it] 99%|█████████▉| 851/858 [2:34:37<01:12, 10.31s/it] 99%|█████████▉| 852/858 [2:34:47<01:01, 10.31s/it] 99%|█████████▉| 853/858 [2:34:57<00:51, 10.30s/it]100%|█████████▉| 854/858 [2:35:08<00:41, 10.31s/it]100%|█████████▉| 855/858 [2:35:18<00:30, 10.31s/it]100%|█████████▉| 856/858 [2:35:28<00:20, 10.31s/it]100%|█████████▉| 857/858 [2:35:39<00:10, 10.30s/it]100%|██████████| 858/858 [2:35:49<00:00, 10.30s/it]/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
  warnings.warn(

  0%|          | 0/64 [00:00<?, ?it/s][A
  3%|▎         | 2/64 [00:02<01:13,  1.18s/it][A
  5%|▍         | 3/64 [00:05<01:50,  1.81s/it][A
  6%|▋         | 4/64 [00:07<02:00,  2.01s/it][A
  8%|▊         | 5/64 [00:09<02:05,  2.13s/it][A
  9%|▉         | 6/64 [00:12<02:08,  2.21s/it][A
 11%|█         | 7/64 [00:14<02:08,  2.26s/it][A
 12%|█▎        | 8/64 [00:16<02:08,  2.29s/it][A
 14%|█▍        | 9/64 [00:19<02:07,  2.32s/it][A
 16%|█▌        | 10/64 [00:21<02:05,  2.33s/it][A
 17%|█▋        | 11/64 [00:23<02:04,  2.34s/it][A
 19%|█▉        | 12/64 [00:26<02:02,  2.35s/it][A
 20%|██        | 13/64 [00:28<01:59,  2.35s/it][A
 22%|██▏       | 14/64 [00:31<01:57,  2.36s/it][A
 23%|██▎       | 15/64 [00:33<01:55,  2.35s/it][A
 25%|██▌       | 16/64 [00:35<01:53,  2.36s/it][A
 27%|██▋       | 17/64 [00:38<01:50,  2.36s/it][A
 28%|██▊       | 18/64 [00:40<01:48,  2.36s/it][A
 30%|██▉       | 19/64 [00:42<01:46,  2.36s/it][A
 31%|███▏      | 20/64 [00:45<01:43,  2.36s/it][A
 33%|███▎      | 21/64 [00:47<01:41,  2.36s/it][A
 34%|███▍      | 22/64 [00:49<01:39,  2.36s/it][A
 36%|███▌      | 23/64 [00:52<01:36,  2.36s/it][A
 38%|███▊      | 24/64 [00:54<01:34,  2.36s/it][A
 39%|███▉      | 25/64 [00:57<01:32,  2.36s/it][A
 41%|████      | 26/64 [00:59<01:29,  2.36s/it][A
 42%|████▏     | 27/64 [01:01<01:27,  2.36s/it][A
 44%|████▍     | 28/64 [01:04<01:24,  2.36s/it][A
 45%|████▌     | 29/64 [01:06<01:22,  2.36s/it][A
 47%|████▋     | 30/64 [01:08<01:20,  2.36s/it][A
 48%|████▊     | 31/64 [01:11<01:17,  2.36s/it][A
 50%|█████     | 32/64 [01:13<01:15,  2.36s/it][A
 52%|█████▏    | 33/64 [01:15<01:13,  2.36s/it][A
 53%|█████▎    | 34/64 [01:18<01:10,  2.36s/it][A
 55%|█████▍    | 35/64 [01:20<01:08,  2.36s/it][A
 56%|█████▋    | 36/64 [01:23<01:06,  2.36s/it][A
 58%|█████▊    | 37/64 [01:25<01:03,  2.36s/it][A
 59%|█████▉    | 38/64 [01:27<01:01,  2.36s/it][A
 61%|██████    | 39/64 [01:30<00:59,  2.36s/it][A
 62%|██████▎   | 40/64 [01:32<00:56,  2.36s/it][A
 64%|██████▍   | 41/64 [01:34<00:54,  2.36s/it][A
 66%|██████▌   | 42/64 [01:37<00:52,  2.36s/it][A
 67%|██████▋   | 43/64 [01:39<00:49,  2.37s/it][A
 69%|██████▉   | 44/64 [01:41<00:47,  2.36s/it][A
 70%|███████   | 45/64 [01:44<00:44,  2.36s/it][A
 72%|███████▏  | 46/64 [01:46<00:42,  2.36s/it][A
 73%|███████▎  | 47/64 [01:49<00:40,  2.37s/it][A
 75%|███████▌  | 48/64 [01:51<00:37,  2.37s/it][A
 77%|███████▋  | 49/64 [01:53<00:35,  2.37s/it][A
 78%|███████▊  | 50/64 [01:56<00:33,  2.36s/it][A
 80%|███████▉  | 51/64 [01:58<00:30,  2.36s/it][A
 81%|████████▏ | 52/64 [02:00<00:28,  2.36s/it][A
 83%|████████▎ | 53/64 [02:03<00:25,  2.36s/it][A
 84%|████████▍ | 54/64 [02:05<00:23,  2.36s/it][A
 86%|████████▌ | 55/64 [02:07<00:21,  2.36s/it][A
 88%|████████▊ | 56/64 [02:10<00:18,  2.36s/it][A
 89%|████████▉ | 57/64 [02:12<00:16,  2.36s/it][A
 91%|█████████ | 58/64 [02:14<00:14,  2.36s/it][A
 92%|█████████▏| 59/64 [02:17<00:11,  2.36s/it][A
 94%|█████████▍| 60/64 [02:19<00:09,  2.36s/it][A
 95%|█████████▌| 61/64 [02:22<00:07,  2.36s/it][A
 97%|█████████▋| 62/64 [02:24<00:04,  2.36s/it][A
 98%|█████████▊| 63/64 [02:26<00:02,  2.36s/it][A
100%|██████████| 64/64 [02:29<00:00,  2.36s/it][A                                                   
                                               [A{'eval_loss': nan, 'eval_runtime': 151.8771, 'eval_samples_per_second': 6.703, 'eval_steps_per_second': 0.421, 'epoch': 2.99}
100%|██████████| 858/858 [2:39:56<00:00, 10.30s/it]
100%|██████████| 64/64 [02:29<00:00,  2.36s/it][A
                                               [A/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
  warnings.warn(
                                                   {'train_runtime': 9691.8536, 'train_samples_per_second': 2.835, 'train_steps_per_second': 0.089, 'train_loss': 9.143056731679778, 'epoch': 2.99}
100%|██████████| 858/858 [2:41:30<00:00, 10.30s/it]100%|██████████| 858/858 [2:41:30<00:00, 11.29s/it]
/home/xinyuzh/anaconda3/envs/meditron/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
  warnings.warn(
[1;34mwandb[0m: 🚀 View run [33m./llama_qa_results[0m at: [34mhttps://wandb.ai/3462549506/huggingface/runs/quzo2msv[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20241217_015705-quzo2msv/logs[0m
[rank0]:[W1217 04:39:23.281011913 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
